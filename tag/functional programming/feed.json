{
    "version": "https://jsonfeed.org/version/1",
    "title": "Icicles of Thought â€¢ All posts by \"functional programming\" tag",
    "description": "",
    "home_page_url": "https://lorefnon.me",
    "items": [
        {
            "id": "https://lorefnon.me/2015/09/21/react-and-livescript-in-harmony.html",
            "url": "https://lorefnon.me/2015/09/21/react-and-livescript-in-harmony.html",
            "title": "React and Livescript in harmony",
            "date_published": "2015-09-21T00:00:00.000Z",
            "content_html": "<h1 id=\"Overview\"><a href=\"#Overview\" class=\"headerlink\" title=\"Overview\"></a>Overview</h1><p><a href=\"http://livescript.net/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">Livescript</a> is a programming language that compiles to readable javascript (similar to coffeescript) and provides language level facilities to <a href=\"http://livescript.net/#inspiration\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">encourage</a> functional programming. <a href=\"https://facebook.github.io/react/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">React.js</a> is a user interface library from <a href=\"https://facebook.com/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">facebook</a> that uses <a href=\"http://calendar.perfplanet.com/2013/diff/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">intelligent heuristics</a> for efficient DOM updates, simplifying the process of building data driven applications. This post outlines how the two can play well together, and tries to demostrate how livescript allows us write much more compact and succinct code. Basic familiarity with both of them is assumed.</p>\n<p>To begin with let us see what a basic component looks like:</p>\n<pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">body</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&#x27;application-container&#x27;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">body</span>&gt;</span></code></pre>\n\n<br>\n\n<pre><code class=\"hljs livescript\">ContactList = React.create-<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">do</span></span>\n  render: -&gt;\n    React.create-element <span class=\"hljs-string\">\\ul,</span> <span class=\"hljs-literal\">null</span>, @props.contacts.<span class=\"hljs-keyword\">map</span> <span class=\"hljs-function\"><span class=\"hljs-params\">(contact)</span>-&gt;</span>\n      React.create-element <span class=\"hljs-string\">\\li,</span> <span class=\"hljs-literal\">null</span>, contact.name\n\nel = React.create-element ContactList, contacts: [\n  * name: <span class=\"hljs-string\">&#x27;Harry Potter&#x27;</span>\n  * name: <span class=\"hljs-string\">&#x27;Albus Dumbledore&#x27;</span>\n]\n\nReact.render el, <span class=\"hljs-built_in\">document</span>.get-element-<span class=\"hljs-keyword\">by</span>-id <span class=\"hljs-string\">\\application-container</span></code></pre>\n\n<img src=\"/images/Screen Shot 2015-09-21 at 12.42.18 pm.png\">\n\n<p>This is very similar to what we would have written if we were using vanilla javascript. The only primary advantages are indentation based nesting, elimination of a lot of superfluous syntax - braces and parenthesis and implicit returns. However we can do much better than this.</p>\n<p>Because Livescript was forked from Coffeescript, it inherits Coffeescript&#39;s class syntax which we can use to extend <code>React.Component</code>. However the benefits of doing so are pretty-much marginal.</p>\n<pre><code class=\"hljs livescript\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">ContactList</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">React</span>.<span class=\"hljs-title\">Component</span></span>\n\n  render: -&gt;\n    React.create-element <span class=\"hljs-string\">\\ul,</span> <span class=\"hljs-literal\">null</span>, @props.contacts.<span class=\"hljs-keyword\">map</span> <span class=\"hljs-function\"><span class=\"hljs-params\">(contact)</span>-&gt;</span>\n      React.create-element <span class=\"hljs-string\">\\li,</span> <span class=\"hljs-literal\">null</span>, contact.name</code></pre>\n\n<p>One thing that we may notice is that the above code does not use <a href=\"https://facebook.github.io/react/docs/jsx-in-depth.html\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">JSX</a>. While yes, it is <a href=\"https://github.com/facebook/react/issues/47#issuecomment-18877423\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">possible</a> to use JSX with livescript using backticks to escape xml constructs and then passing the generated js to babel, it is a hack we better forgo. As we will see soon, livescript native constructs allow for much more succinct expressions than the xml boilerplate that comes JSX.</p>\n<p>Livescript&#39;s feature that almost everything is a expression is particularly helpful when we have conditional logic in our dom generation code.</p>\n<pre><code class=\"hljs livescript\">element = React~create-element\n\nContactList = React.create-<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">do</span></span>\n\n  render: -&gt;\n    element <span class=\"hljs-string\">\\ul,</span> <span class=\"hljs-literal\">null</span>, @props.contacts.<span class=\"hljs-keyword\">map</span> <span class=\"hljs-function\"><span class=\"hljs-params\">(contact)</span>-&gt;</span>\n      element <span class=\"hljs-string\">\\li,</span> <span class=\"hljs-literal\">null</span>,\n        <span class=\"hljs-keyword\">if</span> contact.email\n          element <span class=\"hljs-string\">\\a,</span> href: <span class=\"hljs-string\">&quot;mailto:<span class=\"hljs-subst\">#&#123;contact.email&#125;</span>&quot;</span>, contact.name\n        <span class=\"hljs-keyword\">else</span>\n          contact.name\n\nel = element ContactList, contacts: [\n  * name: <span class=\"hljs-string\">&#x27;Harry Potter&#x27;</span>\n  * name: <span class=\"hljs-string\">&#x27;Albus Dumbledore&#x27;</span>\n    email: <span class=\"hljs-string\">&#x27;albus@hogwarts.magic&#x27;</span>\n]\n\nReact.render el, <span class=\"hljs-built_in\">document</span>.get-element-<span class=\"hljs-keyword\">by</span>-id <span class=\"hljs-string\">\\application-container</span></code></pre>\n\n<img src=\"/images/Screen Shot 2015-09-21 at 12.42.05 pm.png\">\n\n<p>When the render function becomes complex, it is often more readable to use livescript&#39;s pipe operator to chain the operations. This is particularly handy in conjugation with utility libraries geared towards functional programming - the example below uses <a href=\"http://ramdajs.com/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">Ramda</a>. Other alternatives include <a href=\"http://underscorejs.org/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">underscore</a>, <a href=\"https://lodash.com/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">lodash</a>, <a href=\"http://www.preludels.com/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">prelude.ls</a> etc.</p>\n<pre><code class=\"hljs livescript\">element = React~create-element\n\nContactList = React.create-<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">do</span></span>\n\n  render-avatar: <span class=\"hljs-function\"><span class=\"hljs-params\">(contact)</span>-&gt;</span>\n    <span class=\"hljs-keyword\">if</span> contact.avatar\n    <span class=\"hljs-keyword\">then</span> element <span class=\"hljs-string\">\\img,</span> src: contact.avatar, height: <span class=\"hljs-number\">100</span>, width: <span class=\"hljs-number\">100</span>\n    <span class=\"hljs-keyword\">else</span> element <span class=\"hljs-string\">\\span,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">&#x27;N/A&#x27;</span>\n\n  render-label: <span class=\"hljs-function\"><span class=\"hljs-params\">(contact)</span>-&gt;</span>\n    <span class=\"hljs-keyword\">if</span> contact.email\n    <span class=\"hljs-keyword\">then</span> element <span class=\"hljs-string\">\\a,</span> href: <span class=\"hljs-string\">&quot;mailto:<span class=\"hljs-subst\">#&#123;contact.email&#125;</span>&quot;</span>, contact.name\n    <span class=\"hljs-keyword\">else</span> element <span class=\"hljs-string\">\\span,</span> <span class=\"hljs-literal\">null</span>, contact.name\n\n  render-contact-row: <span class=\"hljs-function\"><span class=\"hljs-params\">(contact)</span>-&gt;</span>\n    element <span class=\"hljs-string\">\\tr,</span> key: contact.id, [\n      element <span class=\"hljs-string\">\\td,</span> <span class=\"hljs-literal\">null</span>, @render-avatar contact\n      element <span class=\"hljs-string\">\\td,</span> <span class=\"hljs-literal\">null</span>, @render-label contact\n    ]\n\n  render-head: -&gt;\n    element <span class=\"hljs-string\">\\thead,</span> <span class=\"hljs-literal\">null</span>, [\n      element <span class=\"hljs-string\">\\tr,</span> <span class=\"hljs-literal\">null</span>, [\n        element <span class=\"hljs-string\">\\th,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">&#x27;Avatar&#x27;</span>\n        element <span class=\"hljs-string\">\\th,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">&#x27;Name&#x27;</span>\n      ]\n    ]\n\n  render: -&gt;\n    @props.contacts\n    |&gt; R.<span class=\"hljs-keyword\">map</span> @~render-contact-row\n    |&gt; <span class=\"hljs-function\">~&gt;</span> element <span class=\"hljs-string\">\\tbody,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-literal\">it</span>\n    |&gt; <span class=\"hljs-function\">~&gt;</span> element <span class=\"hljs-string\">\\table,</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>-<span class=\"hljs-title\">name</span>: \\<span class=\"hljs-title\">contacts</span> , [ @<span class=\"hljs-title\">render-head</span>!, <span class=\"hljs-title\">it</span> ]</span>\n\nel = element ContactList, contacts: [\n  * id: <span class=\"hljs-number\">1</span>\n    name: <span class=\"hljs-string\">&#x27;Harry Potter&#x27;</span>\n    avatar: <span class=\"hljs-string\">&#x27;http://cdn.playbuzz.com/cdn/8de88741-d729-4319-aa46-e8a544a20439/f7cade9d-8daf-42b3-8839-3e0e1f3db283.jpeg&#x27;</span>\n  * id: <span class=\"hljs-number\">2</span>,\n    name: <span class=\"hljs-string\">&#x27;Albus Dumbledore&#x27;</span>\n    email: <span class=\"hljs-string\">&#x27;albus@hogwarts.magic&#x27;</span>\n]\n\n\nReact.render el, <span class=\"hljs-built_in\">document</span>.get-element-<span class=\"hljs-keyword\">by</span>-id <span class=\"hljs-string\">\\application-container</span></code></pre>\n\n<img src=\"/images/Screen Shot 2015-09-21 at 2.15.15 pm.png\">\n\n<p>It may be tempting to further shorten the functions taking advantage of livescript&#39;s default argument <code>it</code>:</p>\n<pre><code class=\"hljs livescript\">render-avatar: -&gt;\n  <span class=\"hljs-keyword\">if</span> <span class=\"hljs-literal\">it</span>.avatar\n  <span class=\"hljs-keyword\">then</span> element <span class=\"hljs-string\">\\img,</span> src: <span class=\"hljs-literal\">it</span>.avatar, height: <span class=\"hljs-number\">100</span>, width: <span class=\"hljs-number\">100</span>\n  <span class=\"hljs-keyword\">else</span> element <span class=\"hljs-string\">\\span,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">&#x27;N/A&#x27;</span>\n\nrender-label: -&gt;\n  <span class=\"hljs-keyword\">if</span> <span class=\"hljs-literal\">it</span>.email\n  <span class=\"hljs-keyword\">then</span> element <span class=\"hljs-string\">\\a,</span> href: <span class=\"hljs-string\">&quot;mailto:<span class=\"hljs-subst\">#&#123;<span class=\"hljs-literal\">it</span>.email&#125;</span>&quot;</span>, <span class=\"hljs-literal\">it</span>.name\n  <span class=\"hljs-keyword\">else</span> element <span class=\"hljs-string\">\\span,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-literal\">it</span>.name\n\nrender-contact-row: -&gt;\n  element <span class=\"hljs-string\">\\tr,</span> key: <span class=\"hljs-literal\">it</span>.id, [\n    element <span class=\"hljs-string\">\\td,</span> <span class=\"hljs-literal\">null</span>, @render-avatar <span class=\"hljs-literal\">it</span>\n    element <span class=\"hljs-string\">\\td,</span> <span class=\"hljs-literal\">null</span>, @render-label <span class=\"hljs-literal\">it</span>\n  ]</code></pre>\n\n<p>But I strongly recommend against doing that, because having the arguments specified in the function signature upfront enhances readability.</p>\n<p>Also note that the top down construction flow composition can also be realized in javascript using Ramda&#39;s <code>pipe</code> but livescript just makes it simpler by providing a language level operator.</p>\n<p>For simpler components (which are just responsible for presenting something passed as props, and do not need lifecycle methods etc.) it may be useful to define a micro-component builder:</p>\n<pre><code class=\"hljs livescript\"><span class=\"hljs-function\"><span class=\"hljs-title\">micro-component</span> = <span class=\"hljs-params\">(render)</span>-&gt;</span> React.create-factory React.create-<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> &#123; <span class=\"hljs-title\">render</span> &#125;</span></code></pre>\n\n<p>Once we have that, it makes it a lot more easier for us to follow React&#39;s recommendation of having lightweight modular components which can be easily composed:</p>\n<pre><code class=\"hljs livescript\">ContactAvatar = micro-component -&gt;\n  &#123; contact &#125; = @props\n  <span class=\"hljs-keyword\">if</span> contact.avatar\n  <span class=\"hljs-keyword\">then</span> element <span class=\"hljs-string\">\\img,</span> src: contact.avatar, height: <span class=\"hljs-number\">100</span>, width: <span class=\"hljs-number\">100</span>\n  <span class=\"hljs-keyword\">else</span> element <span class=\"hljs-string\">\\span,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">&#x27;N/A&#x27;</span>\n\nContactLabel = micro-component -&gt;\n  &#123; contact &#125; = @props\n  <span class=\"hljs-keyword\">if</span> contact.email\n  <span class=\"hljs-keyword\">then</span> element <span class=\"hljs-string\">\\a,</span> href: <span class=\"hljs-string\">&quot;mailto:<span class=\"hljs-subst\">#&#123;contact.email&#125;</span>&quot;</span>, contact.name\n  <span class=\"hljs-keyword\">else</span> element <span class=\"hljs-string\">\\span,</span> <span class=\"hljs-literal\">null</span>, contact.name\n\nContactListRow = micro-component -&gt;\n  element <span class=\"hljs-string\">\\tr,</span> key: @props.contact.id, [\n    element <span class=\"hljs-string\">\\td,</span> <span class=\"hljs-literal\">null</span>, ContactAvatar @props\n    element <span class=\"hljs-string\">\\td,</span> <span class=\"hljs-literal\">null</span>, ContactLabel @props\n  ]\n\nContactList = micro-component -&gt;\n  element <span class=\"hljs-string\">\\table,</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>-<span class=\"hljs-title\">name</span>: \\<span class=\"hljs-title\">contacts</span>, [</span>\n    element <span class=\"hljs-string\">\\thead,</span> <span class=\"hljs-literal\">null</span>, [\n      element <span class=\"hljs-string\">\\tr,</span> <span class=\"hljs-literal\">null</span>, [\n        element <span class=\"hljs-string\">\\th,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">&#x27;Avatar&#x27;</span>\n        element <span class=\"hljs-string\">\\th,</span> <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">&#x27;Name&#x27;</span>\n      ]\n    ]\n    element <span class=\"hljs-string\">\\tbody,</span> <span class=\"hljs-literal\">null</span>, @props.contacts.<span class=\"hljs-keyword\">map</span> -&gt; ContactListRow <span class=\"hljs-keyword\">do</span>\n      contact: <span class=\"hljs-literal\">it</span>\n      key: <span class=\"hljs-literal\">it</span>.id\n  ]\n\nel = ContactList contacts: [\n  * id: <span class=\"hljs-number\">1</span>\n    name: <span class=\"hljs-string\">&#x27;Harry Potter&#x27;</span>\n    avatar: <span class=\"hljs-string\">&#x27;http://cdn.playbuzz.com/cdn/8de88741-d729-4319-aa46-e8a544a20439/f7cade9d-8daf-42b3-8839-3e0e1f3db283.jpeg&#x27;</span>\n  * id: <span class=\"hljs-number\">2</span>,\n    name: <span class=\"hljs-string\">&#x27;Albus Dumbledore&#x27;</span>\n    email: <span class=\"hljs-string\">&#x27;albus@hogwarts.magic&#x27;</span>\n]\nReact.render el, <span class=\"hljs-built_in\">document</span>.get-element-<span class=\"hljs-keyword\">by</span>-id <span class=\"hljs-string\">\\application-container</span>\n</code></pre>\n\n<p>Libraries like <a href=\"https://github.com/mlmorg/react-hyperscript\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\"><code>react-hyperscript</code></a> may be used to further reduce the dom construction boilerplate :</p>\n<pre><code class=\"hljs livescript\">\n<span class=\"hljs-built_in\">require</span>! &#123; react-hyperscript: h, react: React &#125;\n\nContactAvatar = micro-component -&gt;\n  &#123; contact &#125; = @props\n  <span class=\"hljs-keyword\">if</span> contact.avatar\n  <span class=\"hljs-keyword\">then</span> h <span class=\"hljs-string\">\\img,</span> src: contact.avatar, height: <span class=\"hljs-number\">100</span>, width: <span class=\"hljs-number\">100</span>\n  <span class=\"hljs-keyword\">else</span> h <span class=\"hljs-string\">\\span,</span> <span class=\"hljs-string\">&#x27;N/A&#x27;</span>\n\nContactLabel = micro-component -&gt;\n  &#123; contact &#125; = @props\n  <span class=\"hljs-keyword\">if</span> contact.email\n  <span class=\"hljs-keyword\">then</span> h <span class=\"hljs-string\">\\a,</span> href: <span class=\"hljs-string\">&quot;mailto:<span class=\"hljs-subst\">#&#123;contact.email&#125;</span>&quot;</span>, contact.name\n  <span class=\"hljs-keyword\">else</span> h <span class=\"hljs-string\">\\span,</span> contact.name\n\nContactListRow = micro-component -&gt;\n  h <span class=\"hljs-string\">\\tr,</span> key: @props.contact.id, [\n    h <span class=\"hljs-string\">\\td,</span> ContactAvatar @props\n    h <span class=\"hljs-string\">\\td,</span> ContactLabel @props\n  ]\n\nContactList = micro-component -&gt;\n  h <span class=\"hljs-string\">\\table.contacts,</span> [\n    h <span class=\"hljs-string\">\\thead,</span> [\n      h <span class=\"hljs-string\">\\tr,</span> [\n        h <span class=\"hljs-string\">\\th,</span> <span class=\"hljs-string\">&#x27;Avatar&#x27;</span>\n        h <span class=\"hljs-string\">\\th,</span> <span class=\"hljs-string\">&#x27;Name&#x27;</span>\n      ]\n    ]\n    h <span class=\"hljs-string\">\\tbody,</span> @props.contacts.<span class=\"hljs-keyword\">map</span> -&gt; ContactListRow <span class=\"hljs-keyword\">do</span>\n      contact: <span class=\"hljs-literal\">it</span>\n      key: <span class=\"hljs-literal\">it</span>.id\n  ]\n\nel = ContactList contacts: [\n  * id: <span class=\"hljs-number\">1</span>\n    name: <span class=\"hljs-string\">&#x27;Harry Potter&#x27;</span>\n    avatar: <span class=\"hljs-string\">&#x27;http://cdn.playbuzz.com/cdn/8de88741-d729-4319-aa46-e8a544a20439/f7cade9d-8daf-42b3-8839-3e0e1f3db283.jpeg&#x27;</span>\n  * id: <span class=\"hljs-number\">2</span>,\n    name: <span class=\"hljs-string\">&#x27;Albus Dumbledore&#x27;</span>\n    email: <span class=\"hljs-string\">&#x27;albus@hogwarts.magic&#x27;</span>\n]\nReact.render el, <span class=\"hljs-built_in\">document</span>.get-element-<span class=\"hljs-keyword\">by</span>-id <span class=\"hljs-string\">\\application-container</span>\n</code></pre>\n\n<p>Apart from getting rid of null for attribute hashes, hyperscript is particularly useful for shorter syntax for class names and ids. Also it insulates our codebase against changes in the DOM builder API, which have happened in past.</p>\n",
            "tags": [
                "Javascript",
                "React",
                "Functional Programming"
            ]
        }
    ]
}