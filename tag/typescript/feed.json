{
    "version": "https://jsonfeed.org/version/1",
    "title": "Icicles of Thought • All posts by \"typescript\" tag",
    "description": "",
    "home_page_url": "https://lorefnon.me",
    "items": [
        {
            "id": "https://lorefnon.me/2021/08/08/Vue-composition-api-and-type-safe-graphql-access/",
            "url": "https://lorefnon.me/2021/08/08/Vue-composition-api-and-type-safe-graphql-access/",
            "title": "Vue composition API and type-safe GraphQL access",
            "date_published": "2021-08-07T00:00:00.000Z",
            "content_html": "<h1 id=\"About-setup-script\"><a href=\"#About-setup-script\" class=\"headerlink\" title=\"About setup script\"></a>About setup script</h1><p>The <a href=\"https://v3.vuejs.org/guide/composition-api-introduction.html\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">vue composition API</a> is pretty cool, esp. with the recent addition of <a href=\"https://github.com/vuejs/rfcs/blob/master/active-rfcs/0040-script-setup.md\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">setup script support</a> in <a href=\"https://blog.vuejs.org/posts/vue-3.2.html\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">Vue 3.2</a> which drastically reduces unnecessary boilerplate when most of the logic is present in the setup function of the component. </p>\n<p>From the announcement post: </p>\n<blockquote>\n<p><code>&lt;script setup&gt;</code> is a <strong>compile-time syntactic sugar</strong> that greatly improves the ergonomics when using Composition API inside SFCs.</p>\n</blockquote>\n<pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">setup</span>&gt;</span>\n<span class=\"javascript\"><span class=\"hljs-keyword\">import</span> &#123; ref &#125; <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;vue&#x27;</span></span>\n\n<span class=\"javascript\"><span class=\"hljs-keyword\">const</span> color = ref(<span class=\"hljs-string\">&#x27;red&#x27;</span>)</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> @<span class=\"hljs-attr\">click</span>=<span class=\"hljs-string\">&quot;color = color === &#x27;red&#x27; ? &#x27;green&#x27; : &#x27;red&#x27;&quot;</span>&gt;</span>\n    Color is: &#123;&#123; color &#125;&#125;\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span></code></pre>\n<h1 id=\"GraphQL-through-Composition-API\"><a href=\"#GraphQL-through-Composition-API\" class=\"headerlink\" title=\"GraphQL through Composition API\"></a>GraphQL through Composition API</h1><p>With <a href=\"https://v4.apollo.vuejs.org/\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">vue-apollo-composable</a> we can use a composable API to access our GraphQL API which can take advantage of above support. </p>\n<p>Lastly, using <a href=\"https://www.graphql-code-generator.com/docs/presets/gql-tag-operations\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">gql-tag-operations-preset</a> we can ensure that we get type-safety while accessing resources over GraphQL. </p>\n<p>This combination works seamlessly and unlike previous codegen based approaches doesn&#39;t require us to manually import types or functions generated from graphql files. </p>\n<p>The rest of this post is primarily an overview of the involved configuration.</p>\n<h1 id=\"Dependencies\"><a href=\"#Dependencies\" class=\"headerlink\" title=\"Dependencies\"></a>Dependencies</h1><p>Currently, my preferred way to get started with Vue project is to scaffold it through vite (<code>yarn create vite</code>) which internally uses the really fast <a href=\"https://github.com/evanw/esbuild\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">esbuild</a> native transpiler. </p>\n<p>Other build tools may require minor adjustment around import aliasing.</p>\n<p>Here is what our package.json looks like: </p>\n<pre><code class=\"hljs json\">&#123;\n  <span class=\"hljs-attr\">&quot;scripts&quot;</span>: &#123;\n    <span class=\"hljs-attr\">&quot;dev&quot;</span>: <span class=\"hljs-string\">&quot;vite&quot;</span>,\n    <span class=\"hljs-attr\">&quot;build&quot;</span>: <span class=\"hljs-string\">&quot;vue-tsc --noEmit &amp;&amp; vite build&quot;</span>,\n    <span class=\"hljs-attr\">&quot;serve&quot;</span>: <span class=\"hljs-string\">&quot;vite preview&quot;</span>,\n    <span class=\"hljs-attr\">&quot;codegen:graphql&quot;</span>: <span class=\"hljs-string\">&quot;yarn run graphql-codegen -c graphql-codegen.yaml&quot;</span>\n  &#125;,\n  <span class=\"hljs-attr\">&quot;dependencies&quot;</span>: &#123;\n    <span class=\"hljs-attr\">&quot;@apollo/client&quot;</span>: <span class=\"hljs-string\">&quot;^3.4.5&quot;</span>,\n    <span class=\"hljs-attr\">&quot;@graphql-typed-document-node/core&quot;</span>: <span class=\"hljs-string\">&quot;^3.1.0&quot;</span>,\n    <span class=\"hljs-attr\">&quot;@vue/apollo-composable&quot;</span>: <span class=\"hljs-string\">&quot;^4.0.0-alpha.14&quot;</span>,\n    <span class=\"hljs-attr\">&quot;graphql&quot;</span>: <span class=\"hljs-string\">&quot;^15.5.1&quot;</span>,\n    <span class=\"hljs-attr\">&quot;graphql-tag&quot;</span>: <span class=\"hljs-string\">&quot;^2.12.5&quot;</span>,\n    <span class=\"hljs-attr\">&quot;vue&quot;</span>: <span class=\"hljs-string\">&quot;^3.0.5&quot;</span>,\n    <span class=\"hljs-attr\">&quot;vue-router&quot;</span>: <span class=\"hljs-string\">&quot;4&quot;</span>\n  &#125;,\n  <span class=\"hljs-attr\">&quot;devDependencies&quot;</span>: &#123;\n    <span class=\"hljs-attr\">&quot;@app/gql&quot;</span>: <span class=\"hljs-string\">&quot;link:./src/gql&quot;</span>,\n    <span class=\"hljs-attr\">&quot;@graphql-codegen/cli&quot;</span>: <span class=\"hljs-string\">&quot;^2.0.1&quot;</span>,\n    <span class=\"hljs-attr\">&quot;@graphql-codegen/gql-tag-operations-preset&quot;</span>: <span class=\"hljs-string\">&quot;^1.0.1&quot;</span>,\n    <span class=\"hljs-attr\">&quot;@graphql-codegen/typescript-graphql-request&quot;</span>: <span class=\"hljs-string\">&quot;^4.0.0&quot;</span>,\n    <span class=\"hljs-attr\">&quot;@vitejs/plugin-vue&quot;</span>: <span class=\"hljs-string\">&quot;^1.4.0&quot;</span>,\n    <span class=\"hljs-attr\">&quot;@vue/compiler-sfc&quot;</span>: <span class=\"hljs-string\">&quot;^3.1.5&quot;</span>,\n    <span class=\"hljs-attr\">&quot;typescript&quot;</span>: <span class=\"hljs-string\">&quot;^4.3.5&quot;</span>,\n    <span class=\"hljs-attr\">&quot;vite&quot;</span>: <span class=\"hljs-string\">&quot;^2.5.0-beta.1&quot;</span>,\n    <span class=\"hljs-attr\">&quot;vue-tsc&quot;</span>: <span class=\"hljs-string\">&quot;^0.2.2&quot;</span>\n  &#125;\n&#125;</code></pre>\n<h1 id=\"Configuration-for-graphql-code-generator\"><a href=\"#Configuration-for-graphql-code-generator\" class=\"headerlink\" title=\"Configuration for graphql-code-generator\"></a>Configuration for graphql-code-generator</h1><p>We have a <code>codegen:graphql</code> script configured above, which we can use to generate types for our GraphQL accessors.</p>\n<p>Here is what our <code>graphql-codegen.yaml</code> looks like: </p>\n<pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">schema:</span> <span class=\"hljs-string\">./schema/schema.graphqls</span>\n<span class=\"hljs-attr\">documents:</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&#x27;src/**/*.ts&#x27;</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&#x27;src/**/*.vue&#x27;</span>\n  <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&#x27;!src/gql/**/*&#x27;</span>\n<span class=\"hljs-attr\">generates:</span> \n  <span class=\"hljs-string\">./src/schema/generated/graphql.d.ts:</span>\n    <span class=\"hljs-attr\">plugins:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">typescript</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">typescript-operations</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">typescript-graphql-request</span>\n  <span class=\"hljs-string\">./src/gql/:</span>\n    <span class=\"hljs-attr\">preset:</span> <span class=\"hljs-string\">gql-tag-operations-preset</span></code></pre>\n<p>From the docs for <a href=\"https://www.graphql-code-generator.com/docs/presets/gql-tag-operations\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">gql-tag-operations-preset</a>: </p>\n<blockquote>\n<p>This preset generates typings for your inline gql function usages, without having to manually specify import statements for the documents. All you need to do is import your gql function and run codegen in watch mode.</p>\n</blockquote>\n<p>Since <code>yarn run</code> forwards our arguments to the underlying scripts, to run the aforementioned watch mode, we can simply run: </p>\n<pre><code class=\"hljs sh\">yarn run codegen:graphql --watch</code></pre>\n<p>This will keep scanning our code for usage of graphql queries/mutations and generate corresponding types.</p>\n<p>We will look at some examples below.</p>\n<h2 id=\"Import-aliasing\"><a href=\"#Import-aliasing\" class=\"headerlink\" title=\"Import aliasing:\"></a>Import aliasing:</h2><p>The last piece of setup we need to do is configuration for imports. </p>\n<p>This may get simplified in future, but as of this writing this needs to be done in both tsconfig.json (in case you are using typescript,  make typescript compiler &amp; editor tooling happy) and vite config (to make vite happy).</p>\n<p>In <code>tsconfig.json</code>: </p>\n<pre><code class=\"hljs\"><table class=\"hlcode-table\"><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">{\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">  <span class=\"hljs-attr\">&quot;compilerOptions&quot;</span>: {\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;target&quot;</span>: <span class=\"hljs-string\">&quot;esnext&quot;</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;module&quot;</span>: <span class=\"hljs-string\">&quot;esnext&quot;</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;moduleResolution&quot;</span>: <span class=\"hljs-string\">&quot;node&quot;</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;strict&quot;</span>: <span class=\"hljs-literal\">true</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;jsx&quot;</span>: <span class=\"hljs-string\">&quot;preserve&quot;</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;sourceMap&quot;</span>: <span class=\"hljs-literal\">true</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;resolveJsonModule&quot;</span>: <span class=\"hljs-literal\">true</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;esModuleInterop&quot;</span>: <span class=\"hljs-literal\">true</span>,\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;lib&quot;</span>: [<span class=\"hljs-string\">&quot;esnext&quot;</span>, <span class=\"hljs-string\">&quot;dom&quot;</span>],\n</td></tr><tr style=\"border:none;background:#fffacd;\" class=\"hlcode-line  hlcode-line-highlight\" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">&quot;paths&quot;</span>: {\n</td></tr><tr style=\"border:none;background:#fffacd;\" class=\"hlcode-line  hlcode-line-highlight\" ><td style=\"border:none\" class=\"hlcode-code-cell\">      <span class=\"hljs-attr\">&quot;@app/gql&quot;</span>: [<span class=\"hljs-string\">&quot;./src/gql&quot;</span>]\n</td></tr><tr style=\"border:none;background:#fffacd;\" class=\"hlcode-line  hlcode-line-highlight\" ><td style=\"border:none\" class=\"hlcode-code-cell\">    }\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">  },\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">  <span class=\"hljs-attr\">&quot;include&quot;</span>: [<span class=\"hljs-string\">&quot;src/**/*.ts&quot;</span>, <span class=\"hljs-string\">&quot;src/**/*.d.ts&quot;</span>, <span class=\"hljs-string\">&quot;src/**/*.tsx&quot;</span>, <span class=\"hljs-string\">&quot;src/**/*.vue&quot;</span>]\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">}\n</td></tr></table></code></pre>\n\n<p>In <code>vite.config.ts</code>: </p>\n<pre><code class=\"hljs\"><table class=\"hlcode-table\"><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\"><span class=\"hljs-keyword\">import</span> { defineConfig } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;vite&#x27;</span>\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\"><span class=\"hljs-keyword\">import</span> vue <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;@vitejs/plugin-vue&#x27;</span>\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\"><span class=\"hljs-keyword\">import</span> { resolve } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;path&quot;</span>;\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\"><span class=\"hljs-comment\">// https://vitejs.dev/config/</span>\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> defineConfig({\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">  <span class=\"hljs-attr\">plugins</span>: [\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    vue()\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">  ],\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">  <span class=\"hljs-attr\">resolve</span>: {\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    <span class=\"hljs-attr\">alias</span>: {\n</td></tr><tr style=\"border:none;background:#fffacd;\" class=\"hlcode-line  hlcode-line-highlight\" ><td style=\"border:none\" class=\"hlcode-code-cell\">      <span class=\"hljs-string\">&quot;@app/gql&quot;</span>: resolve(__dirname, <span class=\"hljs-string\">&quot;./src/gql&quot;</span>)\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">    }\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">  }\n</td></tr><tr style=\"border:none;\" class=\"hlcode-line  \" ><td style=\"border:none\" class=\"hlcode-code-cell\">})\n</td></tr></table></code></pre>\n\n<p>What this enables us to do is to import a helper function from <code>@app/gql</code> which we will use to make graphql queries (or perform mutations). </p>\n<p>And the watcher will keep adding overloads to this helper for each of our usage.</p>\n<h1 id=\"Usage-in-application\"><a href=\"#Usage-in-application\" class=\"headerlink\" title=\"Usage in application\"></a>Usage in application</h1><p>Here is what a usage of this helper looks like in our component: </p>\n<pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span> <span class=\"hljs-attr\">lang</span>=<span class=\"hljs-string\">&quot;pug&quot;</span>&gt;</span>\ndiv(v-if=&quot;loading&quot;)\n  | Loading ...\ndiv(v-else)\n  div(v-if=&quot;result?.currentUser&quot;)\n    | Hello &#123;&#123; result.currentUser.name &#125;&#125;\n  div(v-else)\n    | Not logged in\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">lang</span>=<span class=\"hljs-string\">&quot;ts&quot;</span> <span class=\"hljs-attr\">setup</span>&gt;</span>\n<span class=\"javascript\"><span class=\"hljs-keyword\">import</span> &#123; gql &#125; <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@app/gql&quot;</span></span>\n<span class=\"javascript\"><span class=\"hljs-keyword\">import</span> &#123; useQuery &#125; <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@vue/apollo-composable&quot;</span></span>\n\n<span class=\"javascript\"><span class=\"hljs-keyword\">const</span> &#123; result, loading &#125; = useQuery(</span>\n<span class=\"javascript\">    gql(<span class=\"hljs-comment\">/* GraphQL */</span> <span class=\"hljs-string\">`</span></span>\n        query CurrentUserQuery &#123;\n            currentUser &#123;\n                name\n            &#125;\n        &#125;\n    `)\n)\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></code></pre>\n<p>Note that other than <code>gql</code> we didn&#39;t need to import anything else. And we may get a type error initially, it will quickly disappear once our watcher generates the necessary overloads, and our <code>result</code> and <code>loading</code> variables will be correctly typed as vue refs.</p>\n<p>The result&#39;s value type will be derived from our query and if we update the query, the type will auto-update too.</p>\n<p>And because these are reactive refs, we can directly use them in templates without needing any watchers or cleanup code.</p>\n<p>Lastly, if you are curious, here is what the overloads generated look like: </p>\n<pre><code class=\"hljs typescript\"><span class=\"hljs-keyword\">import</span> * <span class=\"hljs-keyword\">as</span> graphql <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;./graphql&#x27;</span>;\n\n<span class=\"hljs-keyword\">const</span> documents = &#123;\n    <span class=\"hljs-string\">&quot;query CurrentUserQuery &#123;...&#125;&quot;</span>: graphql.CurrentUserQueryDocument,\n&#125;;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">gql</span>(<span class=\"hljs-params\">source: <span class=\"hljs-string\">&quot;query CurrentUserQuery &#123;...&#125;&quot;</span></span>): (<span class=\"hljs-params\"><span class=\"hljs-keyword\">typeof</span> documents</span>)[&quot;<span class=\"hljs-title\">query</span> <span class=\"hljs-title\">CurrentUserQuery</span> </span>&#123;...&#125;<span class=\"hljs-string\">&quot;];</span>\n<span class=\"hljs-string\"></span>\n<span class=\"hljs-string\">export function gql(source: string): unknown;</span>\n<span class=\"hljs-string\">export function gql(source: string) &#123;</span>\n<span class=\"hljs-string\">  return (documents as any)[source] ?? &#123;&#125;;</span>\n<span class=\"hljs-string\">&#125;</span></code></pre>\n<p>Not quite pretty :), but usually you never have to peek into this file at all.</p>\n",
            "tags": [
                "Apollo",
                "GraphQL",
                "Vue",
                "TypeScript"
            ]
        },
        {
            "id": "https://lorefnon.me/2020/02/02/conditionally-making-optional-properties-mandatory-in-typescript/",
            "url": "https://lorefnon.me/2020/02/02/conditionally-making-optional-properties-mandatory-in-typescript/",
            "title": "Conditionally making optional properties mandatory in typescript",
            "date_published": "2020-02-02T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>A common case in applications is to work with types where certain properties are nullable. However, it is also common to need derived types of these same types which are stricter around nullablity of properties.</p>\n<p>Let’s imagine a note taking app: We have a <code>Notebook</code> type where <code>id</code> is nullable because unsaved notebooks haven’t been assigned an <code>id</code> yet. However after saving it, we know for a fact that a <code>Notebook</code> instance will have an <code>id</code> and ideally we shouldn’t have to say <code>notebook.id!</code> in the rest of the application.</p>\n<p>So, in this post we will explore a generic way to derive types like <code>SavedNotebook</code> where certain properties are conditionally mapped to non-optional.</p>\n<p><span id=\"more-681\"></span></p>\n<p>TS comes with a <code>NonNullable</code> type, which essentially strips out <code>null</code> and <code>undefined</code> from any type.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce893c080196261\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce893c080196261-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce893c080196261-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce893c080196261-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce893c080196261-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce893c080196261-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce893c080196261-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">T1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">undefined</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce893c080196261-3\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">T2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NonNullable</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// string</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce893c080196261-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0042 seconds] -->\n<p></p>\n<p>We also have <a class=\"wp-editor-md-post-content-link\" href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html#mapped-types\">mapped types</a> that allow us to map over a type and programmatically derive the type for each key.</p>\n<p>So the following makes all values non-nullable:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce894c519604699\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce894c519604699-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce894c519604699-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce894c519604699-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce894c519604699-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce894c519604699-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce894c519604699-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce894c519604699-2\"><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SavedNotebook</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce894c519604699-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NonNullable</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce894c519604699-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce894c519604699-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>Now, we can use <a class=\"wp-editor-md-post-content-link\" href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html#conditional-types\">conditional types</a> to make only certain values non-nullable:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce8953823116233\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8953823116233-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8953823116233-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8953823116233-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8953823116233-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8953823116233-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8953823116233-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8953823116233-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce8953823116233-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8953823116233-2\"><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SavedNotebook</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8953823116233-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"id\"</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8953823116233-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NonNullable</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8953823116233-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8953823116233-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8953823116233-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n<p>Or, a more generic implementation:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce8958257407111\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8958257407111-9\">9</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-2\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">MandateProps</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">K</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">keyof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-e\">TK </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">keyof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TK </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">K</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NonNullable</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">TK</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">TK</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-8\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SavedNotebook</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">MandateProps</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"id\"</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8958257407111-9\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0014 seconds] -->\n<p></p>\n<p>Our <code>SavedNotebook</code> type will effectively be:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce895d989196490\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce895d989196490-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce895d989196490-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce895d989196490-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce895d989196490-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce895d989196490-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce895d989196490-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce895d989196490-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce895d989196490-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce895d989196490-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce895d989196490-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce895d989196490-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce895d989196490-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">description</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce895d989196490-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce895d989196490-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>Looks good! Are we done then ? It turns out, not quite.</p>\n<p>Let’s tweak our <code>Notebook</code> interface a bit:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce8962456978648\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8962456978648-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8962456978648-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8962456978648-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8962456978648-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8962456978648-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8962456978648-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8962456978648-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce8962456978648-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8962456978648-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Notebook</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8962456978648-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8962456978648-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">name</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8962456978648-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">description</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8962456978648-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8962456978648-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0006 seconds] -->\n<p></p>\n<p>We made the properties optional. Our <code>SavedNotebook</code> type will no longer evaluate to what we expect:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce8966800033072\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8966800033072-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8966800033072-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8966800033072-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8966800033072-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8966800033072-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8966800033072-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8966800033072-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce8966800033072-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8966800033072-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SavedNotebook</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8966800033072-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">undefined</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8966800033072-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">name</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">undefined</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8966800033072-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">description</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">undefined</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8966800033072-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8966800033072-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n<p>What happened here ? Wasn’t our <code>NonNullable</code> type supposed to take care of <em>both</em> <code>null</code> and <code>undefined</code> ?</p>\n<p>Well, it did, but it turns out typescript treats the following as different cases:</p>\n<ol>\n<li>Whether a key may (or may not) be present in an object type</li>\n<li>Whether the corresponding value may be <code>undefined</code>.</li>\n</ol>\n<p>Mapped types preserve the former, and so our <code>MandateProps</code> is not able to remove the <code>undefined</code> from <code>Notebook[\"id\"]</code>.</p>\n<p>So, what should be do if we do want to make that key mandatory as well ?</p>\n<p>Thankfully typescript allows us to suffix our key with <code>-?</code> while mapping over types to remove optionality.</p>\n<p>But doing that conditionally requires another workaround:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce896b987927910\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce896b987927910-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce896b987927910-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce896b987927910-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce896b987927910-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce896b987927910-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce896b987927910-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce896b987927910-2\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">MandateProps</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">K</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">keyof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Omit</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">K</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce896b987927910-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-e\">MK </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">K</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">-</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NonNullable</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">MK</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce896b987927910-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce896b987927910-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0012 seconds] -->\n<p></p>\n<p><code>Omit&lt;T, K&gt;</code> retains all the optional keys that we don’t care about and gets rid of the keys that are assignable to <code>K</code>. Then we create another type for the keys which match <code>K</code>, and while mapping over them we make the keys not optional. Intersection of the both gives us a type where all keys that are assignable to <code>K</code> are mandatory.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce8971862497170\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8971862497170-9\">9</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SavedNotebook</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">MandateProps</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"id\"</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-4\"><span class=\"crayon-c\">// ^ Is equivalent to:</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-6\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SavedNotebook</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Pick</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Notebook</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"name\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"description\"</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-8\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8971862497170-9\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n<p>This is pretty much what we want. <code>Omit</code> is internally implemented using <code>Pick</code> and typescript is being lazy about <code>Pick</code>.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce8976911642548\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8976911642548-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8976911642548-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce8976911642548-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce8976911642548-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce8976911642548-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Omit</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">K</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Pick</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Exclude</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">keyof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">K</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce8976911642548-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0007 seconds] -->\n<p></p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba445ce897b353313842\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba445ce897b353313842-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce897b353313842-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba445ce897b353313842-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba445ce897b353313842-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba445ce897b353313842-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ID</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">SavedNotebook</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"id\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// number</span></div><div class=\"crayon-line\" id=\"crayon-5fba445ce897b353313842-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0004 seconds] -->\n<p></p>\n<p>Voila.</p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        },
        {
            "id": "https://lorefnon.me/2019/11/07/typesafe-tuple-hierarchies-in-typescript/",
            "url": "https://lorefnon.me/2019/11/07/typesafe-tuple-hierarchies-in-typescript/",
            "title": "Type-safe tuple hierarchies in TypeScript",
            "date_published": "2019-11-07T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>I have a love-hate relationship with type safety. Type Checkers can be  amazingly powerful tools when they work and yet can be frustrating every now and then when you hit some unsupported edge case.</p>\n<p>Thankfully more and more of these corners are getting eliminated with the hard work that the typescript team has been putting in.</p>\n<p>One such case that was a PITA was support (or lack thereof) for recursive types in TypeScript.</p>\n<p><span id=\"more-638\"></span></p>\n<p>Let’s say you despise XML/JSX and want to express User interface composition as a composition of tuples.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf48879040309\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf48879040309-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf48879040309-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf48879040309-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf48879040309-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf48879040309-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf48879040309-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf48879040309-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf48879040309-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ui</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf48879040309-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"container\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf48879040309-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf48879040309-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf48879040309-6\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0043 seconds] -->\n<p></p>\n<p>if you are coming from any of lisp-family languages you are probably already habituated to s-expressions for composing interfaces. <a href=\"https://github.com/weavejester/hiccup\">Hiccup</a>, for instance, is a cool<br>\ntemplating language that utilizes s-expressions for consize boilerplate-free template composition.</p>\n<p>So, now, how do we make this type safe.</p>\n<p>Lets try the obvious approach:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf6e735348334\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf6e735348334-16\">16</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-2\"><span class=\"crayon-c\">// Registry of tags and supported attributes</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-3\"><span class=\"crayon-c\">// Simplified for brevity</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-4\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementAttrs</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"span\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-11\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-13\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-14\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-15\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf6e735348334-16\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0019 seconds] -->\n<p></p>\n<p>Until the last stable version of typescript this would have failed because recursive type aliases were not well supported. So we’d be greeted with an error:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf76968424678\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf76968424678-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf76968424678-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf76968424678-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf76968424678-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-v\">lt</span><span class=\"crayon-sy\">;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"span\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"span\"</span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-v\">gt</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">any</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf76968424678-2\"><span class=\"crayon-e\">Type </span><span class=\"crayon-i\">alias</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ElementTuple'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">circularly </span><span class=\"crayon-e\">references </span><span class=\"crayon-v\">itself</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf76968424678-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>Hmm… let us see if we can use utilize the typical trick of using interfaces to work around this:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf7c211814569\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf7c211814569-18\">18</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementAttrs</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"span\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-9\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-11\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-13\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-17\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf7c211814569-18\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0022 seconds] -->\n<p></p>\n<p>This indeed seems to work:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf81046550299\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf81046550299-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf81046550299-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf81046550299-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf81046550299-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf81046550299-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf81046550299-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> t1:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf81046550299-3\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> t2:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"di\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf81046550299-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>TS complains that the second assignment is not valid because:</p>\n<blockquote><p>\n  Type ‘”di”‘ is not assignable to type ‘”div” | “span”‘.\n</p></blockquote>\n<p>There is a caveat though:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf88200281863\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf88200281863-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf88200281863-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf88200281863-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf88200281863-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf88200281863-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> t1:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"junk\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf88200281863-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0007 seconds] -->\n<p></p>\n<p>This passes too !</p>\n<p>Why doesn’t TypeScript complain ? Because our interface just cares about 0|1|2 indexes. If our tuple has other irrelevant things at other indexes, it doesn’t matter – it still satisfies the ElementTuple interface.</p>\n<p>This is a problem for us if we want to support a variable arity tuples for convenience:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf8e227778586\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf8e227778586-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf8e227778586-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf8e227778586-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf8e227778586-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf8e227778586-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf8e227778586-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf8e227778586-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf8e227778586-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf8e227778586-2\"><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// Attributes can be skipped if not needed</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf8e227778586-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf8e227778586-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// Both attributes and children skipped</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf8e227778586-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf8e227778586-6\"><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf8e227778586-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0007 seconds] -->\n<p></p>\n<p>In such cases, typescript’s inference can fallback to type that matches some index and ignore the other indexes (having erroneous values). This can compromise with type safety:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf93566686331\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-21\">21</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-23\">23</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-25\">25</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-27\">27</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-29\">29</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf93566686331-31\">31</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element1Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-6\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-9\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-11\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementChildren2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-14\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-15\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-16\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element3Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-19\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-20\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-21\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-22\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-23\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element1Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-24\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-25\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementChildren2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-26\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element3Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-27\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-28\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> t:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-29\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-30\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">foo</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"bar\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf93566686331-31\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0044 seconds] -->\n<p></p>\n<p>This passes without hiccups ! Why does TypeScript allow random attributes for a div ? Because the nested array can’t match the <code>ElementAttrs2Tuple</code> but can match <code>Element1Tuple</code> so TS doesn’t complain.</p>\n<p>Lets see, if we can do something to restrict the other index positions:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf99905042116\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf99905042116-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element3Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">index</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Exclude</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-7\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf99905042116-8\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0031 seconds] -->\n<p></p>\n<p>Nope. This doesn’t work because:</p>\n<blockquote><p>\n  An index signature parameter type cannot be a type alias.\n</p></blockquote>\n<p>Fortunately, there is a simpler solution to this:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467baf9e773358317\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467baf9e773358317-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Element3Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementAttrs</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-7\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467baf9e773358317-8\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0023 seconds] -->\n<p></p>\n<p>We really just need care about the last position. Because an attempt to create an array literal with anything at index 3 will fail to match Element3Tuple (including undefined, null etc.) So the array size has to match exactly 3.</p>\n<p>We can extend this to the other tuple definitions:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467bafa3489130101\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-21\">21</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-23\">23</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-25\">25</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-27\">27</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-29\">29</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-31\">31</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-33\">33</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafa3489130101-34\">34</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element1Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-7\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-11\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-13\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementChildren2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-17\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-18\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-19\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Element2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementChildren2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-22\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-23\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element3Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-24\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-25\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-26\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-27\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-28\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-29\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-30\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-31\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element1Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-32\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element2Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-33\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Element3Tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafa3489130101-34\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0084 seconds] -->\n<p></p>\n<p>Note that the trailing <code>never</code> property has to always be optional otherwise we will end up with a type that is impossible to match.</p>\n<p>The element tuple that we have now is very close to what we wanted. Go ahead, try it out in the <a href=\"http://www.typescriptlang.org/play/?ts=3.6.3&amp;ssl=48&amp;ssc=25&amp;pln=45&amp;pc=1#code/JYOwLgpgTgZghgYwgAgKIBsIFsLgIJhhQDOyA3sgLABQydyARACbABuDAXOTfb8sEwD8XYkVABzHvQC+AGil0GxAA5wQnbrT50Bw5KKgSFyaTVPUaYAJ7KUGbLjAAVOOOQBeZAGsIVgPYwaJg4+IQkANw0NKCQsIh2wY4AjE4ArsqYADxOyBAAHpAgTKT2Ic6uHkEO4C7iAHyavADaAAwAulxOkVp0TUlteiAQrNDd5tHg0PBIVWUERMQATGkZENm5BbjFs461laW7rg1kxq0dyF2n-VwHoQtNTm3dzYsDXEMjUGNR1DFT8TtwABhAAWwHQTCguGW6SyOXyhW2t3Kbk8yNqx1O7U6z3ofXO6NhECaT1Or0Gw1GZh+1lsgLAMNW6wRWxKiRqFTR7JRDXcxgAPvT5iRGXC6gL6aDwZDoSsxd0JrFpglqmAAMxytbwzZFNmqvZc-VHRp47EXXG9a5CsLEB6knrIJqvG7czUki2OtVvZAfKnUcbUWkqsqa5k6pGuzn0jEeCXIlJE7Lih2C5GirXJ3ip7kaxNOZM0BB+ECiZBgF36omxh1NZhsBiyR3GZp19iNigCLgMABGcCgDBMjaaze0jtbDDak8n4SAA\">playground</a>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467bafab482024145\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafab482024145-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafab482024145-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafab482024145-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafab482024145-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafab482024145-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467bafab482024145-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> t:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafab482024145-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafab482024145-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"bar\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafab482024145-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"div\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafab482024145-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0016 seconds] -->\n<p></p>\n<p>While this may be cool if you like fiddling around the edges of type systems, we have to admit that though we worked around the limitations of typescript, what we ended up with is neither elegant nor intuitive.</p>\n<p>However, with TypeScript 3.7, these workarounds are no longer needed ! Recursive types are fully supported now. This means, we can simply do:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4467bafb2135116150\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafb2135116150-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafb2135116150-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafb2135116150-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafb2135116150-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafb2135116150-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafb2135116150-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4467bafb2135116150-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4467bafb2135116150-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4467bafb2135116150-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTag</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafb2135116150-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafb2135116150-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafb2135116150-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafb2135116150-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementAttrs</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ElementTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4467bafb2135116150-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0045 seconds] -->\n<p></p>\n<p>Cool, consize and minimal. Works <a href=\"http://www.typescriptlang.org/play/?ssl=21&amp;ssc=25&amp;pln=1&amp;pc=1#code/JYOwLgpgTgZghgYwgAgKIBsIFsLgIJhhQDOyA3sgLABQydyARACbABuDAXOTfb8sEwD8XYkVABzHvQC+AGil0GxAA5wQnbrT50Bw5KKgSFyaTVPUaYAJ7KUGbLjAAVOOOQBeZAGsIVgPYwaJg4+IQkANw0ljZ2wY5OAK7KmAA8TsgQAB6QIEyk9iHOrh5BDuAu4gB8HsYAPsgA2k4AunWNTrKlhQRExE3NrVp09U2dBfFJmA0DbaNdjj0k-WNx5ZMQ082RFtQIfiCiyGBc42vJKO7GDcxsDJ0NxrzXLOydFAJcDABGcFAMJvdHtpGjd2ANweEgA\">too</a> !</p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        },
        {
            "id": "https://lorefnon.me/2019/08/18/deriving-interfaces-from-classes-in-typescript/",
            "url": "https://lorefnon.me/2019/08/18/deriving-interfaces-from-classes-in-typescript/",
            "title": "Deriving interfaces from classes in TypeScript",
            "date_published": "2019-08-18T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>Most object oriented programming languages encourage the pattern of <a class=\"wp-editor-md-post-content-link\" href=\"https://tuhrig.de/programming-to-an-interface/\">Programming to an interface</a>. TypeScript supports this of course, you can create one or more interfaces, and then define classes (or factories) that generate instances of this interface.</p>\n<p>However, as the linked article above points out, programming to an interface is sometimes overused when the programmer anticipates the possibility of multiple concrete implementations in future although there may exist just one at the time of implementation.</p>\n<p>But, until these multiple implementations are actually required, these single-implementation interfaces continue to increase maintenance overhead, because every time we need to introduce a new member, we need to modify two places. Sure, the tooling helps with this but it still not ideal.</p>\n<p>Also, relying on just the concrete implementation is not ideal because TypeScript compiler service doesn’t yet have a good mechanism to bulk-replace all usage of a concrete implementation with the corresponding interface should we need multiple implementations in future.</p>\n<p>So, in this post we explore two features of typescript that may help us with this.<br>\n<span id=\"more-622\"></span></p>\n<h1>Interfaces derived from classes</h1>\n<p>A lesser known feature of TypeScript is that interfaces can be derived from classes.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4468f1d79369408977\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d79369408977-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d79369408977-2\">2</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4468f1d79369408977-1\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SyncBackend</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FSSyncBackend</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d79369408977-2\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0026 seconds] -->\n<p></p>\n<p>It may seem like a no-brainer that this is a solution for our use case. But there is an important caveat: All private/protected members of the implementation are exposed in the derived interface.</p>\n<p>If you are surprised by this, you wouldn’t be alone. I found it highly counter-intuitive when I encountered it first, but the rationale behind this is explained in the <a class=\"wp-editor-md-post-content-link\" href=\"https://www.typescriptlang.org/docs/handbook/interfaces.html\">official docs</a>:</p>\n<blockquote><p>\n  When an interface type extends a class type it inherits the members of the class but not their implementations. It is as if the interface had declared all of the members of the class without providing an implementation. Interfaces inherit even the private and protected members of a base class. This means that when you create an interface that extends a class with private or protected members, that interface type can only be implemented by that class or a subclass of it.</p>\n<p>  This is useful when you have a large inheritance hierarchy, but want to specify that your code works with only subclasses that have certain properties. The subclasses don’t have to be related besides inheriting from the base class.\n</p></blockquote>\n<p>So, that is all good, but if we want just the public members, what do we do ?<br>\nThankfully a simple solution exists:</p>\n<h1>Using Mapped types</h1>\n<p>We can use <a class=\"wp-editor-md-post-content-link\" href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-1.html\">mapped types</a> derived from public members of a type.</p>\n<p>Since a class definition is implicitly a type definition, this works well for classes too:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4468f1d87855263947\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d87855263947-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d87855263947-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d87855263947-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d87855263947-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4468f1d87855263947-1\"><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SyncBackend</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d87855263947-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-i\">K</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">FSSyncBackend</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FSSyncBackend</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">K</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d87855263947-3\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d87855263947-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0007 seconds] -->\n<p></p>\n<p>Now <code>SyncBackend</code> type will have only public members of <code>FSSyncBackend</code> class.</p>\n<p>While for most uses this solves our purpose, but if we strictly need an interface &amp; not an alias (perhaps to improve type error messages), we can simply define an interface that extends from this alias:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4468f1d8b787760405\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d8b787760405-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d8b787760405-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d8b787760405-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d8b787760405-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d8b787760405-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4468f1d8b787760405-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4468f1d8b787760405-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SyncBackend</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d8b787760405-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-i\">K</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">FSSyncBackend</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FSSyncBackend</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">K</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d8b787760405-3\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d8b787760405-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d8b787760405-5\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SyncBackend</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SyncBackend</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4468f1d8b787760405-6\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n<p>Eventually if we do need multiple implementations, we can choose to either have an explicitly defined interface or keep one implementation as the canonical implementation, derive the interface from it and make the other implementations comply to that.</p>\n<p>I usually resort to the latter when the other implementations are not for public consumption and exist just for stubbing in test cases.</p>\n<p>If multiple implementations are actually exposed then the former solution (explicitly defined interface) helps with separating the API documentation of the interface from the documentation of individual implementations.</p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        },
        {
            "id": "https://lorefnon.me/2019/08/15/dealing-with-circular-type-references-in-mobx-state-tree/",
            "url": "https://lorefnon.me/2019/08/15/dealing-with-circular-type-references-in-mobx-state-tree/",
            "title": "Dealing with circular type references in Mobx-state-tree",
            "date_published": "2019-08-15T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>A frequently occuring issue when creating interrelated MST models, is that of circular type references.</p>\n<p>Usually we don’t don’t have to explicitly define interfaces for our models, because they can be inferred for us through the APIs exposed by MST. However, when defining models that depend on each other, this falls short because TypeScript’s type-inference is not good enough to circular dependencies.</p>\n<p>For example, lets say we have a note taking application with <code>Snippet</code> and <code>Annotation</code> models. A <code>Snippet</code> can have many <code>Annotation</code>s and every <code>Annotation</code> belongs to exactly one <code>Snippet</code>.</p>\n<p>Our first stab might be something like this:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9a9679920934\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-21\">21</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9a9679920934-23\">23</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-2\"><span class=\"crayon-c\">// models/Snippet.ts</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-4\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">types </span><span class=\"crayon-st\">as</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"mobx-state-tree\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-5\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">v4 </span><span class=\"crayon-st\">as</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">uuid</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"uuid\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-6\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Annotation</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"./Annotation\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-8\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">model</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Snippet\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">optional</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">identifier</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">uuid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-11\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-13\"><span class=\"crayon-c\">// models/Annotation.ts</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-14\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-15\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">types </span><span class=\"crayon-st\">as</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"mobx-state-tree\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-16\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">v4 </span><span class=\"crayon-st\">as</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">uuid</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"uuid\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-17\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Snippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"./Snippet\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-18\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-19\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">model</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Annotation\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">optional</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">identifier</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">uuid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">snippet</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">reference</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-22\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9a9679920934-23\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0073 seconds] -->\n<p></p>\n<p>However, this will not work out well because of the aforementioned issue with circular dependency, and we will get following error:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9bd558713277\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9bd558713277-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9bd558713277-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9bd558713277-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9bd558713277-1\"><span class=\"crayon-s\">'Snippet'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">implicitly </span><span class=\"crayon-e\">has </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'any'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">because </span><span class=\"crayon-e\">it </span><span class=\"crayon-e\">does </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">have</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">type </span><span class=\"crayon-e\">annotation </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">referenced </span><span class=\"crayon-e\">directly </span><span class=\"crayon-st\">or</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">indirectly </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">its </span><span class=\"crayon-e\">own </span><span class=\"crayon-v\">initializer</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9bd558713277-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9bd558713277-3\"><span class=\"crayon-s\">'Annotation'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">implicitly </span><span class=\"crayon-e\">has </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'any'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">because </span><span class=\"crayon-e\">it </span><span class=\"crayon-e\">does </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">have</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">type </span><span class=\"crayon-e\">annotation </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">referenced </span><span class=\"crayon-e\">directly </span><span class=\"crayon-st\">or</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">indirectly </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">its </span><span class=\"crayon-e\">own </span><span class=\"crayon-v\">initializer</span><span class=\"crayon-sy\">.</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0014 seconds] -->\n<p></p>\n<p>We would want to resolve this, but at the same time, use the automatic inference as much as possible so we don’t have to define the entire model type ourselves.</p>\n<p>MST allows us to define our models in multiple stages:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9c3787886264\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c3787886264-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c3787886264-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c3787886264-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c3787886264-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c3787886264-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c3787886264-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c3787886264-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c3787886264-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">model</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Snippet\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c3787886264-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">optional</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">identifier</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">uuid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c3787886264-3\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c3787886264-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c3787886264-5\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1.props</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c3787886264-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c3787886264-7\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0019 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>This split is not arbitrary. While we haven’t quite solved the problem yet, but we note that for <code>Snippet$1</code> our model types can be inferred as there are no circular references there.</p>\n<p>The idea is to augment the inferred type of <code>Snippet$1</code> model with a manual specification of types of attributes which cause circular reference.</p>\n<p>Before we start on that, lets take a step back and reflect on following two facts we can leverage:</p>\n<ol>\n<li>TypeScript interfaces can have circular references. While inferred types and type aliases are eager resolved (atleast as of this writing), interfaces can have mutual dependencies.<p></p>\n</li>\n<li>\n<p>The type of an MST model is <code>IType&lt;ISnapshotInType, ISnapshotOutType, IInstanceType&gt;</code> where:</p>\n<ol>\n<li><code>ISnapshotInType</code> is what we can pass to <code>Model.create</code>.</li>\n<li><code>ISnapshotOutType</code> is what we get back in <code>onSnapshot</code> hook.</li>\n<li><code>IInstanceType</code> is the type of the model instances.</li>\n</ol>\n</li>\n</ol>\n<p>So for our case, if we were not using MST, we would have defined an <code>ISnippet</code> interface something like:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9c9118492127\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c9118492127-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c9118492127-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c9118492127-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9c9118492127-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c9118492127-1\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c9118492127-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c9118492127-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9c9118492127-4\"><span class=\"crayon-sy\">&#125;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0006 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>We can still do that, but the idea of this post is to avoid duplication of type definitions as much as possible because in real applications we would have many more attributes, and we wouldn’t want to keep them in sync across MST models and manually defined instance types.</p>\n<p>If you are wondering why <code>ISnapshotInType</code> and <code>ISnapshotOutType</code> can be different, the answer is right there above. Our model has id as an optional attribute with a factory function for supplying default values. So in our <code>ISnapshotInType</code> for Snippet (lets call it <code>ISnippetSnapshotIn</code>), id will be optional, but in the outgoing snapshot type it will always be present.</p>\n<p>MST also supports <a class=\"wp-editor-md-post-content-link\" href=\"https://github.com/mobxjs/mobx-state-tree#lifecycle-hooks-for-typesmodel\">pre-process and post-process hooks</a> and when using them our incoming and outgoing snapshot types will often diverge.</p>\n<p>MST also allows us to extract<sup><a href=\"#extract-types\" id=\"extract-types-back\">[1]</a></sup> out the Snapshot types and Instance types for cases where inference is possible.</p>\n<p>So <code>Instance&lt;typeof Snippet$1&gt;</code> gives us the Instance type of <code>Snippet$1</code> model which is basically <code>&#123; id: string &#125;</code>.<br>\nSimilarly we can extract out <code>SnapshotIn&lt;typeof Snippet$1&gt;</code> and <code>SnapshotOut&lt;typeof Snippet$1&gt;</code> which are the incoming and outgoing snapshot types respectively.</p>\n<p>So, armed with above insights, lets us augment the extracted types from <code>Snippet$1</code> with the additional attributes we need for our <code>Snippet</code> model:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9cf416703410\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9cf416703410-21\">21</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">model</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Snippet\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">optional</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">identifier</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">uuid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-3\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-5\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Instance</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotation</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-7\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-9\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippetSnapshotIn</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotIn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationSnapshotIn</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-11\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-13\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippetSnapshotOut</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotOut</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationSnapshotOut</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-15\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-16\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-17\"><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ISnippetRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">ISnippetSnapshotIn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ISnippetSnapshotOut</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ISnippet</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-18\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-19\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> Snippet:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ISnippetRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1.props</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9cf416703410-21\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0041 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>Similarly, for <code>Annotation</code>:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9d5863581117\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9d5863581117-21\">21</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">model</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Annotation\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">optional</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">identifier</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">uuid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-3\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-5\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotation</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Instance</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Annotation</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">snippet</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ISnippet</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-7\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-9\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotationSnapshotIn</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotIn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Annotation</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">snippet</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ReferenceIdentifier</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-11\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-13\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotationSnapshotOut</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotOut</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Annotation</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">snippet</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ReferenceIdentifier</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-15\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-16\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-17\"><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">IAnnotationRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">IAnnotationSnapshotIn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationSnapshotOut</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotation</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-18\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-19\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> Annotation:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1.props</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">snippet</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">reference</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9d5863581117-21\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0033 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>This solves our problem and we can conclude here, but I wanted to take this opportunity to highlight a potential caveat with the above implementation.</p>\n<p>Let’s say we decide to add a <code>title</code> field to our <code>Snippet</code> model, and we accidentally add it to <code>Snippet</code>:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9db958078312\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9db958078312-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9db958078312-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9db958078312-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9db958078312-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9db958078312-1\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> Snippet:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ISnippetRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1.props</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9db958078312-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9db958078312-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">title</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9db958078312-4\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>Because we aren’t using the inferred type from <code>Snippet</code> and we haven’t manually updated the types of <code>ISnippet</code>, <code>ISnippetSnapshotIn</code> and <code>ISnippetSnapshotOut</code>, we will run into an error when we try to create a snippet with a title:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9e0705144719\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9e0705144719-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9e0705144719-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">snippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">create</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">&#123;</span><span class=\"crayon-v\">title</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"foo\"</span><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>Above code fails with:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9e5319533974\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9e5319533974-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9e5319533974-2\">2</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9e5319533974-1\"><span class=\"crayon-e\">Argument </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&#123; title: string; &#125;'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">assignable </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">parameter </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ISnippetSnapshotIn'</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9e5319533974-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-t\">Object</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">literal </span><span class=\"crayon-e\">may </span><span class=\"crayon-e\">only </span><span class=\"crayon-e\">specify </span><span class=\"crayon-e\">known </span><span class=\"crayon-v\">properties</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'title'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">does </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">exist </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ISnippetSnapshotIn'</span><span class=\"crayon-sy\">.</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n<p>So, yeah we have type-safety and the type-error points us to the correct direction but we got that error only after we tried to instantiate <code>Snippet</code> with a title and nothing before then.</p>\n<p>One might wonder what if we could make such a mistake impossible to make in the first place.</p>\n<p>The solution, as <a class=\"wp-editor-md-post-content-link\" href=\"https://stackoverflow.com/questions/47124309/how-to-declaratively-enforce-compatibility-of-types\">suggested</a> by SO user <a class=\"wp-editor-md-post-content-link\" href=\"https://stackoverflow.com/users/2887218/jcalz\">jcalz</a> is through witness types which exist solely to check compatibility of types:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9ea404796817\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ea404796817-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ea404796817-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ea404796817-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ea404796817-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ea404796817-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ExtendsWitness</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">U</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">U</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ea404796817-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>Now to take advantage of the <code>ExtendsWitness</code> we can update our <code>Snippet</code> model such that instead of specifying the type of <code>Snippet</code> we just explicitly substitute the parts causing circular dependency with <code>any</code>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9ef551857959\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ef551857959-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ef551857959-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ef551857959-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ef551857959-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ef551857959-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ef551857959-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ef551857959-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ef551857959-2\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1.props</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ef551857959-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ef551857959-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">title</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ef551857959-5\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ef551857959-6\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n<p>We don’t have a type error because the function passed to <code>t.late</code> explicitly returns <code>any</code>.</p>\n<p>Now, lets define witness types for the types extracted from <code>Snippet</code> (which is possible because our use of <code>any</code> has eliminated the circular dependency issue):</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9f4092753155\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9f4092753155-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9f4092753155-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9f4092753155-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9f4092753155-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9f4092753155-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9f4092753155-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">_ISnippetSnapshotInWitness</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ExtendsWitness</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">ISnippetSnapshotIn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">SnapshotIn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9f4092753155-3\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">_ISnippetSnapshotOutWitness</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ExtendsWitness</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">ISnippetSnapshotOut</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">SnapshotOut</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9f4092753155-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p>Our compiler will now start complaining about that title:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9f9320088353\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9f9320088353-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9f9320088353-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9f9320088353-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9f9320088353-1\"><span class=\"crayon-i\">Type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ISnippetSnapshotOut'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">does </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">satisfy </span><span class=\"crayon-e\">the </span><span class=\"crayon-i\">constraint</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ModelSnapshotType&lt;{ id: IOptionalIType&lt;ISimpleType&lt;string&gt;, [undefined]&gt;; } &amp; { annotations: IArrayType&lt;any&gt;; title: ISimpleType&lt;string&gt;; }&gt;'</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9f9320088353-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9f9320088353-3\"><span class=\"crayon-i\">Type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ISnippetSnapshotOut'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">does </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">satisfy </span><span class=\"crayon-e\">the </span><span class=\"crayon-i\">constraint</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ModelSnapshotType&lt;{ id: IOptionalIType&lt;ISimpleType&lt;string&gt;, [undefined]&gt;; } &amp; { annotations: IArrayType&lt;any&gt;; title: ISimpleType&lt;string&gt;; }&gt;'</span><span class=\"crayon-sy\">.</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p>Note that the order of types here is important, because <code>ExtendsWitness&lt;SnapshotIn&lt;typeof Snippet&gt;, ISnippetSnapshotIn&gt;</code> will happily pass. We need to ensure that what we are extracting after any-substitution remains a subtype of what we are declaring as our final type.</p>\n<p>The reported errors will go away when we move our title from <code>Snippet</code> to <code>Snippet$1</code>:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3b9ff939225499\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3b9ff939225499-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">model</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Snippet\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">optional</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">identifier</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">uuid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">title</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-4\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-6\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1.props</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3b9ff939225499-8\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0018 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>If we define a similar witness type for <code>ISnippet</code> we will encounter another error:</p>\n<p><code>type _ISnippetWitness = ExtendsWitness<isnippet, instance<typeof=\"\" snippet=\"\">&gt;;</isnippet,></code></p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3ba04228311725\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba04228311725-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba04228311725-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba04228311725-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba04228311725-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba04228311725-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3ba04228311725-1\"><span class=\"crayon-i\">Type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ISnippet'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">does </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">satisfy </span><span class=\"crayon-e\">the </span><span class=\"crayon-i\">constraint</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ModelInstanceTypeProps&lt;&#123; id: IOptionalIType&lt;ISimpleType&lt;string&gt;, [undefined]&gt;; title: ISimpleType&lt;string&gt;; &#125; &amp; &#123; annotations: IArrayType&lt;any&gt;; &#125;&gt; &amp; IStateTreeNode&lt;IModelType&lt;&#123; id: IOptionalIType&lt;ISimpleType&lt;string&gt;, [...]&gt;; title: ISimpleType&lt;...&gt;; &#125; &amp; &#123; ...; &#125;, &#123;&#125;, _NotCustomized, _NotCustomized&gt;&gt;'</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba04228311725-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-i\">Type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ISnippet'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">assignable </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'ModelInstanceTypeProps&lt;&#123; id: IOptionalIType&lt;ISimpleType&lt;string&gt;, [undefined]&gt;; title: ISimpleType&lt;string&gt;; &#125; &amp; &#123; annotations: IArrayType&lt;any&gt;; &#125;&gt;'</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba04228311725-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">Types </span><span class=\"crayon-e\">of </span><span class=\"crayon-m\">property</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'annotations'</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">are </span><span class=\"crayon-v\">incompatible</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba04228311725-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-i\">Type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'IAnnotation[]'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">assignable </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'IMSTArray&lt;any&gt; &amp; IStateTreeNode&lt;IArrayType&lt;any&gt;&gt;'</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba04228311725-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-i\">Type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'IAnnotation[]'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">missing </span><span class=\"crayon-e\">the </span><span class=\"crayon-e\">following </span><span class=\"crayon-e\">properties </span><span class=\"crayon-e\">from </span><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'IMSTArray&lt;any&gt;'</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">spliceWithArray</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">observe</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">intercept</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">clear</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">more</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2344</span><span class=\"crayon-sy\">]</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0020 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>This happens because our manually defined instance type <code>ISnippet</code> uses a plain array where in the instance we would actually have an <code>IMSTArray</code> which <a class=\"wp-editor-md-post-content-link\" href=\"https://en.wikipedia.org/wiki/Duck_typing\">quacks like</a> an array, but is also MST aware (handles references, snapshot types etc.) and obsevervable.</p>\n<p>So we can update our <code>ISnippet</code> implementation to use an <code>IMSTArray</code>:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3ba0b862130930\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba0b862130930-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba0b862130930-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba0b862130930-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3ba0b862130930-1\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Instance</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba0b862130930-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IMSTArray</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">IAnnotationRunType</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba0b862130930-3\"><span class=\"crayon-sy\">&#125;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>So the witnesses potentially safeguards against hard(-er) to debug errors at invocation sites by identifying them close to the definition site itself.</p>\n<p>However, when we added witness types we removed our augmented type annotation from Snippet (<code>export const Snippet: ISnippetRunType = ...</code> to <code>export const Snippet = ...</code>). While this enabled us to add witnesses for the types derived from <code>Snippet</code>, these derived types have strictly less information than <code>ISnippetRunType</code> and so when exporting we would want to export a model of type <code>ISnippetRunType</code>:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3ba10153273011\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-21\">21</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba10153273011-23\">23</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-1\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippet</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Instance</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IMSTArray</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">IAnnotationRunType</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-3\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-5\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippetSnapshotIn</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotIn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-sy\">?</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationSnapshotIn</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-7\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-9\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippetSnapshotOut</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotOut</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationSnapshotOut</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-11\"><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-13\"><span class=\"crayon-e\">export </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippetRunType </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">ISnippetSnapshotIn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ISnippetSnapshotOut</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ISnippet</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-14\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-15\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">1.props</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">annotations</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-17\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-18\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-19\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">_ISnippetSnapshotInWitness</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ExtendsWitness</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">ISnippetSnapshotIn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">SnapshotIn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-20\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">_ISnippetSnapshotOutWitness</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ExtendsWitness</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">ISnippetSnapshotOut</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">SnapshotOut</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-21\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">_ISnippetWitness</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ExtendsWitness</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">ISnippet</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Instance</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-22\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba10153273011-23\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> Snippet:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ISnippetRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0039 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>Note that we have also replaced the previous type alias (ISnippetRunType) with an interface which we can use as the return types of <code>t.late</code> (because interfaces can have cyclic dependencies).</p>\n<p>We could do exactly the same thing for <code>Annotation.ts</code>, but we can do better.</p>\n<p>We can further take advantage of the fact that interfaces can have cyclic-dependencies to reduce the boilerplate in <code>Annotation.ts</code> to the extent that we won’t even need the intermediate type <code>Annotation$1</code>:</p>\n<p><code></code></p><code>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba446a3ba17417090421\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba446a3ba17417090421-12\">12</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-1\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">model</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Annotation\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">optional</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">identifier</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">uuid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">snippet</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">reference</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">late</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ISnippetRunType</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Snippet</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-4\"><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-6\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotation</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Instance</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Annotation</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#125;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-8\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotationSnapshotIn</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotIn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Annotation</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-9\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-10\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotationSnapshotOut</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SnapshotOut</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Annotation</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#125;</span></div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-11\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba446a3ba17417090421-12\"><span class=\"crayon-e\">export </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotationRunType </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">IAnnotationSnapshotIn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IAnnotationSnapshotOut</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IAnnotation</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#123;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">&#125;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0055 seconds] -->\n<p></p>\n</code><p><code></code></p>\n<p>Obviously we can’t do this for both <code>Snippet</code> and <code>Annotation</code> because TypeScript will not allow us to define a type such that its definition will use itself.</p>\n<p>So with this, we are finally done 🖖.</p>\n<hr>\n<p><sup><a href=\"#extract-types-back\" id=\"extract-types\">[1]</a></sup> My <a class=\"wp-editor-md-post-content-link\" href=\"/2018/07/18/unwrapping-composite-types-in-typescript/\">post on unwrapping composite types</a> goes into more detail around TypeScript features that enable us to extract out types of members of a composite type.</p>\n<p>PS: You’d note that we had to write quite a bit of boilerplate to ensure type-safety. I am writing an inline code-generator called <a class=\"wp-editor-md-post-content-link\" href=\"https://github.com/lorefnon/InGenR\">InGenR</a> that helps with automating this kind of thing using code-generation. If this interests you I’d be more than happy to receive feedback and contributions.</p>\n\n\n    ",
            "tags": [
                "Typescript",
                "MobX",
                "MobX-State-Tree"
            ]
        },
        {
            "id": "https://lorefnon.me/2019/08/11/enforcing-runtime-validations-at-compile-time-in-typescript/",
            "url": "https://lorefnon.me/2019/08/11/enforcing-runtime-validations-at-compile-time-in-typescript/",
            "title": "Enforcing runtime validations at compile time in TypeScript",
            "date_published": "2019-08-11T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>The title may sound something like an oxymoron, so perhaps some clarification is needed.</p>\n<p>I freqently deal with operations against databases. When I mention that I increasingly prefer using a functional style, in particular, using a query builder directly as opposed to an ORM – one of the primary concerns brought up by people is that ORMs can ensure that data validations are performed for every operation that performs a mutation against the data source.</p>\n<p>This post is not much of a rant against ORMs. It is a practical outline of how we can utilize types to ensure (at compile time) that our data access layer only allows validated data. Even if the actual validation happens at runtime.</p>\n<p><span id=\"more-582\"></span></p>\n<p>Let’s say we have a <code>User</code> type:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471174ce777419878\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471174ce777419878-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174ce777419878-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174ce777419878-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174ce777419878-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174ce777419878-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174ce777419878-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471174ce777419878-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174ce777419878-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">User</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174ce777419878-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174ce777419878-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">email</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174ce777419878-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174ce777419878-6\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0027 seconds] -->\n<p></p>\n<p>Now assume that we have a function <code>enrollUser</code> where we only want to allow valid users. If our function takes a <code>User</code> object:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471174da405233932\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471174da405233932-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174da405233932-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174da405233932-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174da405233932-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174da405233932-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471174da405233932-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174da405233932-2\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">enrollUser</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">async</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">User</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174da405233932-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// ... enrollment logic</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174da405233932-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174da405233932-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>In the above, it is possible for this function to be called with either a valid or an invalid user and it is up to consumers invoking this function to ensure that this is called after validating, which can be error prone in larger applications.</p>\n<p>So, lets try to enforce at the type level that this function will only consume valid users. We can do something like:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471174de983989256\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471174de983989256-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174de983989256-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174de983989256-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174de983989256-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174de983989256-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174de983989256-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174de983989256-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471174de983989256-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174de983989256-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Valid</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">_isValid</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174de983989256-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174de983989256-4\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">enrollUser</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Valid</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">User</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174de983989256-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// ... enrollment logic</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174de983989256-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174de983989256-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n<p>Now, our validator functions will have to tell the compiler that a user is indeed valid:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471174e2193180767\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e2193180767-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e2193180767-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e2193180767-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e2193180767-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e2193180767-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e2193180767-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e2193180767-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471174e2193180767-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174e2193180767-2\"><span class=\"crayon-e\">export </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">validateUser</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">User</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">user </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Valid</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">User</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e2193180767-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">!</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">email</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">!</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">email</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">match</span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">/</span><span class=\"crayon-o\">^</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">S</span><span class=\"crayon-o\">+</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">S</span><span class=\"crayon-o\">+</span><span class=\"crayon-sy\">$</span><span class=\"crayon-o\">/</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e2193180767-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// (Don't use that regex in real applications).</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e2193180767-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e2193180767-6\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e2193180767-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0014 seconds] -->\n<p></p>\n<p><code>validateUser</code> here acts as <a class=\"wp-editor-md-post-content-link\" href=\"https://basarat.gitbooks.io/typescript/docs/types/typeGuard.html\">type-guard</a> telling the compiler if the user complies to <code>Valid&lt;User&gt;</code> type.</p>\n<p>So, now if we try to invoke enrollUser with a user that has not been validated we will get an error:</p>\n<p><img src=\"/wp-content/uploads/2019/08/enrolluser.png\" alt=\"\"></p>\n<p>But if we validate it first, the error goes away:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471174e5655426667\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e5655426667-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e5655426667-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e5655426667-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e5655426667-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e5655426667-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471174e5655426667-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174e5655426667-2\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">validateUser</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e5655426667-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">enrollUser</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e5655426667-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e5655426667-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>There is one caveat with this approach though:</p>\n<p>Our type-guard is lying to the compiler and the compiler believes that lie unconditionally:</p>\n<p><img src=\"/wp-content/uploads/2019/08/userisvalidproperty.png\" alt=\"\"></p>\n<p>Here TypeScript is telling us that we have an <code>_isValid</code> property in user but that is not exactly true, because that property will not be present at runtime. So if someone comes to rely on a runtime check on that property, the check will fail at runtime. So effectively we have traded possibility of one runtime fault for another.</p>\n<p>We can do a couple of things to prevent this. The obvious one is to actually have a <code>_isValid</code> property in the object. Or to wrap the type of objects being validated (so that the primary record type can be directly serialized):</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471174e8354605648\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174e8354605648-9\">9</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Validated</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TTarget</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TValid</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">boolean</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">target</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TTarget</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">isValid</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TValid</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-7\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Valid</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TTarget</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Validated</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TTarget</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-8\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Invalid</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TTarget</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Validated</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TTarget</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174e8354605648-9\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0015 seconds] -->\n<p></p>\n<p>However, ff we don’t want any runtime overhead at all, instead of a string property we can use a <a class=\"wp-editor-md-post-content-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol\">symbol</a>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471174eb758520154\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471174eb758520154-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174eb758520154-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174eb758520154-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174eb758520154-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471174eb758520154-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471174eb758520154-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174eb758520154-2\"><span class=\"crayon-r\">declare</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> isValid:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">unique </span><span class=\"crayon-v\">symbol</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174eb758520154-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471174eb758520154-4\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Valid</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">isValid</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471174eb758520154-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p>The benefit of using a symbol is that, as long as this symbol is not exported from the containing module or namespace, it will not be possible to use it at runtime. <a class=\"wp-editor-md-post-content-link\" href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html\">TypeScript 2.7 release announcements</a> go into more details on type level treatment of unique symbols.</p>\n<p>No other symbol (even if they have the same name) will be equal to this symbol. This will hold true even if <code>Symbol</code> is polyfilled.</p>\n<p><img src=\"/wp-content/uploads/2019/08/symbolduplicate.png\" alt=\"\"></p>\n<p>TypeScript autocompletion will not show this as a completion candidate, eliminating the possibility of accidental usage:</p>\n<p><img src=\"/wp-content/uploads/2019/08/symbolcompletions.png\" alt=\"\"></p>\n\n\n    ",
            "tags": [
                "Typescript",
                "io-ts"
            ]
        },
        {
            "id": "https://lorefnon.me/2019/05/02/using-boxing-to-prevent-distribution-of-conditional-types/",
            "url": "https://lorefnon.me/2019/05/02/using-boxing-to-prevent-distribution-of-conditional-types/",
            "title": "Using Boxing to prevent distribution of conditional types",
            "date_published": "2019-05-02T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>TypeScript <a class=\"wp-editor-md-post-content-link\" href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html#conditional-types\">conditional types</a> have an interesting property that they can “distribute” over union types. As explained better by the <a class=\"wp-editor-md-post-content-link\" href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html#distributive-conditional-types\">official docs</a>:</p>\n<blockquote><p>\n  Conditional types in which the checked type is a naked type parameter are called distributive conditional types. Distributive conditional types are automatically distributed over union types during instantiation. For example, an instantiation of <code>T extends U ? X : Y</code> with the type argument <code>A | B | C</code> for <code>T</code> is resolved as <code>(A extends U ? X : Y) | (B extends U ? X : Y) | (C extends U ? X : Y)</code>.\n</p></blockquote>\n<p>While I understand the rationale behind this behavior, this can sometimes lead to somewhat non-intuitive outcomes in real-world scenarios:</p>\n<p><span id=\"more-570\"></span></p>\n<p>For example, let us consider following usage:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471ef19e550077826\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-21\">21</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-23\">23</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-25\">25</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-27\">27</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-29\">29</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-31\">31</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-33\">33</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-34\">34</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef19e550077826-35\">35</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TBase</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TKeys</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">_base</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TBase</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">_keys</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TKeys</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-8\"><span class=\"crayon-r\">declare</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">namespace</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">DeferredKeySelection</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-9\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">SetBase</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TSelection</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TBase</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TSelection </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">TKeys</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-12\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TBase</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TKeys</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TBase</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-15\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-16\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">AddKey</span><span class=\"crayon-o\">&lt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">TSelection</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">TKey </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-19\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TSelection </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">TBase</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">TKeys</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TBase</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TKeys</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TKey</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-22\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-23\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Augment</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TBase</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TKey </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">AddKey</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">SetBase</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TBase</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TKey</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-24\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-25\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Resolve</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TSelection</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TSelection </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-26\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">Base</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-27\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">Keys</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-28\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-29\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Keys </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">Base</span><span class=\"crayon-sy\">?</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-30\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">Pick</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Base</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">Base</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-31\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">any</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-32\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TSelection</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-33\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-34\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef19e550077826-35\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0059 seconds] -->\n<p></p>\n<p>It was <a class=\"wp-editor-md-post-content-link\" href=\"https://github.com/tgriesser/knex/pull/3168\">written</a> to model a fluent API (of <a class=\"wp-editor-md-post-content-link\" href=\"https://knexjs.org/\">Knex query builder</a>) where the base type of a partial could be available later, for example:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471ef1ab318307946\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1ab318307946-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1ab318307946-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1ab318307946-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1ab318307946-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471ef1ab318307946-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1ab318307946-2\"><span class=\"crayon-e\">await </span><span class=\"crayon-v\">knex</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">User</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"users\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">select</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"id\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"name\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// Resolves to Pick&lt;User, \"id\" | \"name\"&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1ab318307946-3\"><span class=\"crayon-e\">await </span><span class=\"crayon-v\">knex</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">select</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"id\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"name\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">from</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">User</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"users\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// Resolves to Pick&lt;User, \"id\" | \"name\"&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1ab318307946-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p>Note that we can’t just use <code>Pick</code> directly in select’s return value because it is possible that the base type (User above) hasn’t been provided yet.</p>\n<p>So, instead we use a container type for bookkeeping and use <code>DeferredKeySelection.Resolve</code> to resolve it – basically deferring the Pick operation till the <a class=\"wp-editor-md-post-content-link\" href=\"https://github.com/tgriesser/knex/blob/cc109c4cadb06e6ed6909fe6dd2002398bf67eab/types/index.d.ts#L934-L936\">termination of the fluent chain</a>. If this pattern of using an identically named interface and namespace pair seems strange, checkout my <a class=\"wp-editor-md-post-content-link\" href=\"/2018/11/30/simplifying-generics-heavy-typescript-code-using-container-interfaces-extractor-types-and-companion-namespaces/\">previous post</a> on the topic.</p>\n<p>However, if we try to use it, we will notice something strange:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471ef1af088739162\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1af088739162-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1af088739162-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1af088739162-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1af088739162-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471ef1af088739162-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1af088739162-2\"><span class=\"crayon-i\">type</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Resolve</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">User</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"id\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">&gt;&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1af088739162-3\"><span class=\"crayon-c\">// Pick&lt;User, \"id\"&gt; | Pick&lt;User, \"age\"&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1af088739162-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>We might have expected the resolved type (<code>T</code>) to be <code>Pick&lt;User, \"id\" | \"age\"&gt;</code> here but of course that is not the case because of the distributive behavior of conditional types mentioned above.</p>\n<p>Fortunately the solution is very simple, we can box the first type parameter of conditional so it is no longer a simple union type:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4471ef1b3266345075\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4471ef1b3266345075-13\">13</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-2\"><span class=\"crayon-c\">// A container type to wrap the value in an object</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-3\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Boxed</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">_value</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-5\"><span class=\"crayon-c\">// Later:</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-6\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ResolveSingle</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">TSelection</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">TSelection </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DeferredKeySelection</span><span class=\"crayon-o\">&lt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-7\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">Base</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">infer</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Keys</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-9\"><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Base</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Boxed</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Keys</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Boxed</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">Base</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Pick</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Base</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Keys</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">keyof </span><span class=\"crayon-v\">Base</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span></div><div class=\"crayon-line\" id=\"crayon-5fba4471ef1b3266345075-13\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TSelection</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0021 seconds] -->\n<p></p>\n<p></p>\n<p>Now our Resolve function behaves as we would expect.</p>\n<p>(PS. The container types here have no runtime overhead because we never any values/instances of these types. They are just used for type-level book-keeping).</p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        },
        {
            "id": "https://lorefnon.me/2019/03/24/using-comlink-with-typescript-and-worker-loader/",
            "url": "https://lorefnon.me/2019/03/24/using-comlink-with-typescript-and-worker-loader/",
            "title": "Using comlink with typescript and worker-loader",
            "date_published": "2019-03-24T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p><a href=\"https://github.com/webpack-contrib/worker-loader\">worker-loader</a> and <a href=\"https://github.com/GoogleChromeLabs/comlink\">comlink</a> are two solution which make web-workers a joy to use. This short post summarizes how to make them play well with each other in a typescript codebase.</p>\n<p><span id=\"more-548\"></span></p>\n<h2>What is comlink ?</h2>\n<p>Comlink is a Google project that implements a proxy based RPC mechanism to invoke methods on objects present in web-workers.</p>\n<p>Being proxy based, most of the times invocation is fairly transparent and the outcome is a lot easier to read than if we were using postMessage and MessagePort APIs directly. Internally of-course comlink use the same APIs under the hood.</p>\n<p>Comlink’s <a href=\"https://github.com/GoogleChromeLabs/comlink/blob/master/README.md\">README</a> already outlines the usage adequately and also David East has <a href=\"https://davidea.st/articles/comlink-simple-web-worker\">written</a> a great introduction to Comlink here, so this post will mostly focus on usage with typescript.</p>\n<h2>Worker loader</h2>\n<p>worker-loader is a webpack plugin that makes it trivial to use webworkers with webpack. When you are using webpack, you’d usually want to have hash appended file paths for <a href=\"https://webpack.js.org/guides/caching/\">long term caching</a> and worker-loader removes the need to refer to a manifest to derive the file path to be used for passing to Worker constructor.</p>\n<p>With worker-loader installed, we can simply do:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44b380fab472108539\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fab472108539-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fab472108539-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fab472108539-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44b380fab472108539-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fab472108539-2\"><span class=\"crayon-e\">import </span><span class=\"crayon-e\">ExpensiveProcessor </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"worker-loader!../core/expensive-processor.worker\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fab472108539-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0023 seconds] -->\n<p></p>\n<p>And it will create a separate webpack chunk, and generate a facade class instantiating which gives us the worker instance. This worker instance happens to be what <a href=\"https://github.com/GoogleChromeLabs/comlink#comlinkproxyendpoint\">Comlink.proxy</a> expects, so we can just pass it on.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44b380fba197430070\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fba197430070-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-2\"><span class=\"crayon-c\">// expensive-processor.worker.ts</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-3\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ExpensiveProcessor</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* ... async methods here ... */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-7\"><span class=\"crayon-v\">Comlink</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">expose</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ExpensiveProcessor</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fba197430070-8\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0006 seconds] -->\n<p></p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44b380fbe773217982\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fbe773217982-9\">9</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-2\"><span class=\"crayon-c\">// main.ts</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-4\"><span class=\"crayon-e\">import </span><span class=\"crayon-e\">ExpensiveProcessor </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"worker-loader!../core/expensive-processor.worker\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-6\"><span class=\"crayon-c\">// Later inside an async function:</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-7\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ProcessorFacade</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Comlink</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">proxy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ExpensiveProcessor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-8\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">processor</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">await </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ProcessorFacade</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fbe773217982-9\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n<h2>Typescript integration</h2>\n<p>The last piece here is to make typescript play well. Because as of now, typescript has no way to figure out the type of the imported ExpensiveProcessor because the code generated by webpack doesn’t go through the type checker.</p>\n<p>The first step is to declare an <a href=\"https://www.typescriptlang.org/docs/handbook/modules.html#ambient-modules\">ambient module</a> having a <a href=\"https://www.typescriptlang.org/docs/handbook/modules.html#wildcard-module-declarations\">wildcard declaration</a> for all worker-loader related imports so that worker-loader imports are identified as Worker implementations.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44b380fc2143634162\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc2143634162-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-2\"><span class=\"crayon-r\">declare</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">module</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"worker-loader!*\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WebpackWorker</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Worker</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">constructor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">export </span><span class=\"crayon-st\">default</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">WebpackWorker</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-7\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc2143634162-8\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0013 seconds] -->\n<p></p>\n<p>The second step is to pass a type parameter to Comlink.proxy:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44b380fc5795232898\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc5795232898-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc5795232898-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc5795232898-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc5795232898-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44b380fc5795232898-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc5795232898-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ProcessorFacade</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Comlink</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">proxy</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Promise</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">IProcessorFacade</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ExpensiveProcessor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc5795232898-3\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">processor</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">await </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ProcessorFacade</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc5795232898-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>Here <code>IProcessorFacade</code> is an interface implemented by ExpensiveProcessor that defines a subset of the public API that plays well with <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\">structured cloning</a>.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44b380fc8612717809\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b380fc8612717809-13\">13</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-2\"><span class=\"crayon-c\">// expensive-processor.worker.ts</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-3\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IProcessorFacade</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* ... Methods whose arguments are either compatible with structured-cloning or have been wrapped in </span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-5\"><span class=\"crayon-c\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Comlink.proxyValue ... */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-8\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ExpensiveProcessor</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">implements</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IProcessorFacade</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* ... async methods here ... */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-11\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-12\"><span class=\"crayon-v\">Comlink</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">expose</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ExpensiveProcessor</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b380fc8612717809-13\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n<p>Of course, this generics based implementation is not exactly type safe even though it eliminates all type errors.</p>\n<p>The reason is that there is nothing stopping us from exposing something that doesn’t implement <code>IProcessorFacade</code> but until the typescript’s <a href=\"https://github.com/Microsoft/TypeScript/wiki/Using-the-Compiler-API\">compile time transformation API</a> gets well supported by all ts ecosystem tooling, the only practical solution is to use a lint rule based on file name conventions if this is a concern.</p>\n\n\n    ",
            "tags": [
                "Typescript",
                "Comlink",
                "Web-workers"
            ]
        },
        {
            "id": "https://lorefnon.me/2019/01/20/exposing-the-type-of-a-typescript-class-while-hiding-the-implementation/",
            "url": "https://lorefnon.me/2019/01/20/exposing-the-type-of-a-typescript-class-while-hiding-the-implementation/",
            "title": "Exposing the type of a typescript class while hiding the implementation",
            "date_published": "2019-01-20T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>When we define a typescript class, we are actually defining two things, a constructor function, and a type. The instances constructed using the constructor defined by a class will have the type of the class.</p>\n<p>One might wonder, if it is possible, say from a library, to expose only the type of the class and not the actual type constructor. The goal here may be to prevent direct instantiation of the class, or prevent consumers from monkeying around with the prototype chain of the constructor.</p>\n<p><span id=\"more-536\"></span></p>\n<p>Of course, direct instantiation can be prevented using private constructors, but that is only if the consumers are using typescript. A consumer using plain javascript, or who is liberal with use of <code>any</code> is more than welcome to instatiate the class directly.</p>\n<p>One obvious approach is that we could define an interface, make our class implement the interface and expose just the interface.</p>\n<p>This works, but requires quite a bit of extra effort and duplication of signatures (assuming that interface is being created just for this purpose only).</p>\n<p>But, what if we could just strip out the run time entity (constructor function) of a class definition, and just retain the type of the class. This is indeed possible and very easy to do.</p>\n<p>We can just make an interface which extends a class (and doesn’t add anything extra).</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44b559193905619872\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44b559193905619872-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b559193905619872-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b559193905619872-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b559193905619872-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44b559193905619872-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44b559193905619872-1\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PersonImpl</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b559193905619872-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b559193905619872-3\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44b559193905619872-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44b559193905619872-5\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PersonImpl</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0016 seconds] -->\n<p></p>\n<p>Exporting this interface provides our typescript consumers access to the type of the class, but doesn’t provide anyone access to the constructor function or the prototype chain.</p>\n<p>If we are not ever exposing any instance of this class, and the class is for internal use only, we are pretty much done here.</p>\n<p>However, in case we are exposing instances of this class, then we are not finished, because, any instance of the class also facilitates access to the constructor through the constructor property (which can be overriden) and the prototype chain can be accessed through <code>Object.getPrototypeOf</code> or the controversial (and legacy <code>__proto__</code> property.</p>\n<p>The safest way to completely hide the implementation of prototype chain while exposing the instances is to wrap the instances in a Proxy that delegates method access and property access to the underlying target instance.</p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        },
        {
            "id": "https://lorefnon.me/2018/11/30/simplifying-generics-heavy-typescript-code-using-container-interfaces-extractor-types-and-companion-namespaces/",
            "url": "https://lorefnon.me/2018/11/30/simplifying-generics-heavy-typescript-code-using-container-interfaces-extractor-types-and-companion-namespaces/",
            "title": "Simplifying generics-heavy typescript code using Container Interfaces, Extractor Types and Companion Namespaces",
            "date_published": "2018-11-30T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>Writing generics-heavy code code in Typescript can sometimes be arduous, especially because typescript doesn’t facilitate <a href=\"https://en.wikipedia.org/wiki/Kind_(type_theory)\">higher kinded types</a> at language level.</p>\n<p>So, a function that accepts multiple arguments of generic types often has to accept type parameters of all these generic types in order to retain type safety:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307ba276703523\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ba276703523-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307ba276703523-1\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">func</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T3</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">p1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T2</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">W3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T3</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0020 seconds] -->\n<p></p>\n<p>This can get cumbersome fast, especially when the parameterized types have constraints on the type parameters because now these constraints also have to be replicated:</p>\n<p><span id=\"more-508\"></span></p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307ca064617820\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ca064617820-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ca064617820-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ca064617820-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ca064617820-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ca064617820-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307ca064617820-1\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T1 </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">T5</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ca064617820-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">t1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ca064617820-3\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ca064617820-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ca064617820-5\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">func</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T1 </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T5</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">p1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T2</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">W3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T3</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0021 seconds] -->\n<p></p>\n<p>If the constraint <code>T1 extends T4, T5</code> is not replicated over to <code>func</code> it will result in a compilation error. The above example illustrates a function, but of course the same idea carries over to consumer interfaces etc. as well.</p>\n<p>This is a chore when the combination of the same types (here T1, T2, T3) with identical type constraints have to be used in multiple places.</p>\n<p>With the introduction of conditional types in <a href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html\">typescript@2.8</a> we now have the ability to <a href=\"/2018/07/18/unwrapping-composite-types-in-typescript/\">extract out</a> generic type parameters from parameterized types. We can use this to our advantage to reduce the redundancy in scenarios like above by defining <strong>Container Types</strong>.</p>\n<p>These container types are not intended to be used by themsevles. So although in some cases container types may coincide with application domain types, often we would not have any objects of these types in runtime.</p>\n<p>Example:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307ce686289998\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307ce686289998-11\">11</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-1\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">T1 </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T4</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">T2</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">T3</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-5\"><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// These variables are present just so to prevent the tooling</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// from nagging us to remove unused types</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">_t1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">T2</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-9\"><span class=\"crayon-e\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">_t2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T2</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">_t3</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T3</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307ce686289998-11\"><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0016 seconds] -->\n<p></p>\n<p>Now we can define an unparameterized derived type which we can use instead of the three type parameters:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307d1545186339\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307d1545186339-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307d1545186339-1\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FuncParamsU </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n<p>We would usually want this to be the minimally lax type that satisfies all the constraints. For example, in above case we could use <code>any</code> as the first type parameter but we used <code>T4</code> (assuming <code>T4</code> is some concrete type) for better type safety.</p>\n<p>But now, we need to extract the member types from <code>FuncParamsU</code> for using them in places where the member types are expected.</p>\n<p>Conditional types to the rescue:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307d4745960612\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307d4745960612-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307d4745960612-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307d4745960612-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307d4745960612-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">FuncParamsT1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParamsU</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">T1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307d4745960612-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">FuncParamsT2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParamsU</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">T2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307d4745960612-3\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">FuncParamsT3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParamsU</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">T3</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T3</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0026 seconds] -->\n<p></p>\n<p>These <strong>Extractor Types</strong> (sometimes called <strong>Type Operators</strong> in a more generic contexts) serve to pull out specific generic parameters from the <strong>Container Type</strong>.</p>\n<p>Now we can redefine our func function as follows:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307d7604243649\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307d7604243649-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307d7604243649-1\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">func</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParamsU</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">p1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">FuncParamsT1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">FuncParamsT2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">W3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">FuncParamsT3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>This has become somewhat longer, but is more advantageous in that if we need to modify one of the involved constraints, we would have to modify only the FuncParams interface.</p>\n<p>Note that when we need to use FuncParams, we also need to pull in all these extractor types.</p>\n<p>Another helpful pattern here is to define a <strong>Companion Namespace</strong> for every <strong>Container Type</strong> which contains all the associated type operators:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307da420181365\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307da420181365-19\">19</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-1\"><span class=\"crayon-c\">// FuncParams.ts</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-2\"><span class=\"crayon-e\">export </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">T1 </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T4</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">T2</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">T3</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-6\"><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// These variables are present just so to prevent the tooling</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// from nagging us to remove unused types</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">_t1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">T2</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-10\"><span class=\"crayon-e\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">_t2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T2</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">_t3</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T3</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-12\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-13\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-14\"><span class=\"crayon-e\">export</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">namespace</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FuncParams</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">export </span><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Zilch </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">T1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Zilch</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">T1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">T2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Zilch</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">T2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">export </span><span class=\"crayon-e\">type </span><span class=\"crayon-v\">T3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Zilch</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">infer </span><span class=\"crayon-v\">T3</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T3</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">never</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307da420181365-19\"><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0040 seconds] -->\n<p></p>\n<p>The use of the same name for the <strong>Container Interface</strong> and its <strong>Companion Namespace</strong> is purely a matter of convention, but it helpful for logical correlation that <code>FuncParams.T1</code> is the extractor type to pull out <code>T1</code> from <code>FuncParams&lt;T1, T2, T3&gt;</code>.</p>\n<p>Another side benefit is that only a single import is required to import the Container Type as well as the Companion Namespace.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307de090800839\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307de090800839-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307de090800839-1\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"./FuncParams\"</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// Imports both FuncParams interface as well as FuncParams namespace</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0004 seconds] -->\n<p></p>\n<p>So now our <code>func</code> implementation can be:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d3307e0033263312\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307e0033263312-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307e0033263312-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307e0033263312-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307e0033263312-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307e0033263312-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d3307e0033263312-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d3307e0033263312-1\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"./FuncParams\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307e0033263312-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d3307e0033263312-3\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">func</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Zilch</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307e0033263312-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">p1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">T1</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307e0033263312-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">p2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">T2</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d3307e0033263312-6\"><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">W3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">FuncParams</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">T3</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0014 seconds] -->\n<p></p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        },
        {
            "id": "https://lorefnon.me/2018/07/18/unwrapping-composite-types-in-typescript/",
            "url": "https://lorefnon.me/2018/07/18/unwrapping-composite-types-in-typescript/",
            "title": "Unwrapping composite types in Typescript",
            "date_published": "2018-07-18T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>One of the interesting aspects in Typescript is that it is easy to extract out individual types from composite types.</p>\n<p><span id=\"more-313\"></span> </p>\n<p>In case of Array, Tuple and Object types, this is really simple, as the type extraction syntax mimic member access syntax.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc53005203051\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc53005203051-14\">14</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-6\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">PersonName</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Person</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"name\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// string</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-8\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">StrNumTuple</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-9\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-10\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">StrNumTuple0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">StrNumTuple</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// string</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-11\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-12\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">NumArr</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-13\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc53005203051-14\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">NumArrMember</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NumArr</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// number</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0020 seconds] -->\n<p></p>\n<p>The object access syntax works for interfaces too, which is quite intuitive:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc60097321365\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc60097321365-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc60097321365-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc60097321365-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc60097321365-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc60097321365-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc60097321365-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc60097321365-1\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc60097321365-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc60097321365-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc60097321365-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc60097321365-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc60097321365-6\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">PersonName</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Person</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"name\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// string</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0017 seconds] -->\n<p></p>\n<p>However, more interesting is that, we can extract types from generics and functions too.</p>\n<p>Let us say we have the following Dictionary type</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc63825027321\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc63825027321-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc63825027321-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc63825027321-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc63825027321-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc63825027321-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc63825027321-1\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Dictionary</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc63825027321-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">key</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc63825027321-3\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc63825027321-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc63825027321-5\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">StrDict</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Dictionary</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">string</span><span class=\"crayon-o\">&gt;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n<p>To extract <code>T</code> from <code>StrDict</code>, we can use the above member property approach:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc67932639042\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc67932639042-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc67932639042-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">StrDictMember</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">StrDict</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// string</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0006 seconds] -->\n<p></p>\n<p>However, another alternative here is to use typescript’s <code>infer</code> keyword along with <a href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html\">conditional types</a>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc6a842913670\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc6a842913670-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc6a842913670-2\">2</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc6a842913670-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">DictMember</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Dictionary</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">infer</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">V</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">V</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">never</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc6a842913670-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">StrDictMember</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">DictMember</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">StrDict</span><span class=\"crayon-o\">&gt;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>The conditional type <a href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html\">introduced</a> in Typescript 2.8 allows us to arrive at different types based on some conditions. The condition here being a type compatibility constraint.</p>\n<p>Not that even though <code>extends</code> keyword is used, this does not necessarily enforce an inheritance relationship, but rather checks for <a href=\"https://www.typescriptlang.org/docs/handbook/type-compatibility.html\">structural compatibility</a>.</p>\n<p><code>infer</code> introduces a <i>type variable</i> here, which can be later collected in the type the conditional type <i>resolves</i> to.</p>\n<p>This can be used to collect types from arbitrary generic types using typescript’s inference algorithm.</p>\n<p>The same appraoch can be used to extract types from functions too. For example, following type (borrowed from typescript’s <a href=\"https://github.com/Microsoft/TypeScript/blob/d2f6f6a0a48ef5a218eed1bc0e44236f2f5cbc30/lib/lib.es5.d.ts#L1411\">collection</a> of built in types), allows us to extract the return value of function.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc6d849182383\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc6d849182383-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc6d849182383-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ReturnType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">args</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">args</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">infer</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">R</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">R</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0020 seconds] -->\n<p></p>\n<p>The analogous approach can be used for arguments too:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc70102394537\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc70102394537-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc70102394537-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc70102394537-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc70102394537-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc70102394537-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Fn1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc70102394537-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ArgType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">infer</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">U</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">U</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc70102394537-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc70102394537-4\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Fn1Arg</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ArgType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Fn1</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// number</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0023 seconds] -->\n<p></p>\n<p>Things get somewhat more interesting, if we want to extract the tuple type of <strong>all the arguments</strong>.</p>\n<p>Typescript 3.0-rc <a href=\"https://blogs.msdn.microsoft.com/typescript/2018/07/12/announcing-typescript-3-0-rc/#tuples-and-parameters\">introduces</a> support for extracting and spreading parameter lists with tuples. So using <code>typescript@next</code> we can do something like:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc73338060731\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc73338060731-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc73338060731-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc73338060731-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc73338060731-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc73338060731-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc73338060731-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">VariadicFn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">args</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc73338060731-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ArgsType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">VariadicFn</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">infer</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc73338060731-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc73338060731-4\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Fn2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc73338060731-5\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Fn2Args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ArgsType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Fn2</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// [number, string]</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0031 seconds] -->\n<p></p>\n<p>It may be tempting to do something like: </p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc76115805678\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc76115805678-1\">1</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc76115805678-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">ArgsType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">args</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">infer</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">U</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">any</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">U</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">never</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\">&nbsp;&nbsp;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0016 seconds] -->\n<p></p>\n<p>This will not work as expected, because <code>U</code> now has to satisfy the type at every position.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44d01dc79788373604\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc79788373604-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44d01dc79788373604-2\">2</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44d01dc79788373604-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Fn2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44d01dc79788373604-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">Fn2Args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ArgsType</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Fn2</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// (number &amp; string)[]</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        },
        {
            "id": "https://lorefnon.me/2018/05/13/reasonml-vs-typescript-first-impressions/",
            "url": "https://lorefnon.me/2018/05/13/reasonml-vs-typescript-first-impressions/",
            "title": "ReasonML vs TypeScript – First impressions",
            "date_published": "2018-05-13T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>This post summarizes preliminary observations while comparing <a target=\"_blank\" href=\"https://reasonml.github.io/\">ReasonML</a> and <a target=\"_blank\" href=\"https://www.typescriptlang.org/\">TypeScript</a> during selection of a reasonably (pun-intended) type safe language for frontend development. The observations here are somewhat biased in favor of experienced javascript developers and focusses primarily on frontend development workflow and does not take into account the (primary) native backend of Reason.</p>\n<p>While this post primarily compares Reason and TypeScript, much of what is outlined about TypeScript equally applies to <a target=\"_blank\" href=\"https://flow.org/\">flow</a> as well.</p>\n<p><span id=\"more-173\"></span></p>\n<h2>Compatibility with ECMAScript semantics</h2>\n<p>TypeScript was designed from ground up to be a javascript superset. So all javascript experience naturally carries over to TypeScript.</p>\n<p>Reason is an <a target=\"_blank\" href=\"https://ocaml.org/\">OCaml</a> dialect. A different language that has nothing to do with ECMAScript. period.</p>\n<p>This gets slightly blurred because of Reason team’s efforts to bring in some javascript inspired syntax sugar to OCaml. So lists look like javascript arrays, records look like javascript objects, functions look like javascript arrow functions, spread syntax looks the same etc. But these syntactic similarities are very much skin deep and while they may aid in muscle memory, one has to keep in mind while writing any non-trivial code that Reason is a different language with very different semantics. We will revisit these semantic differences at multiple places in the later sections of this post.</p>\n<p>However it is worth highlighting that most of the ReasonML best practices also map to best practices in Modern javascript. The official documentation elaborates on this in the <a href=\"https://reasonml.github.io/docs/en/what-and-why.html\" target=\"_blank\">What &amp; Why</a> section that explains the motivation behind the ReasonML.</p>\n<p>When we say that we are comparing TypeScript with Reason in this post, we are <em>actually</em> comparing TypeScript with the combination of <a target=\"_blank\" href=\"https://ocaml.org/\">OCaml</a> (The underlying language which provides the type system) + <a target=\"_blank\" href=\"https://bucklescript.github.io/\">BuckleScript</a> (The OCaml -&gt; Javascript compiler, a fork of the primary OCaml compiler) + <a target=\"_blank\" href=\"https://reasonml.github.io/\">Reason</a> (The javascript inspired dialect for OCaml – implemented as a frontend for the OCaml compiler).</p>\n<h2>Type safety</h2>\n<p>TypeScript is intentionally <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Gradual_typing\">“gradually-typed”</a>. TypeScript compiler supports various levels of strictness which can be <a target=\"_blank\" href=\"https://www.typescriptlang.org/docs/handbook/compiler-options.html\">configured</a> through the tsconfig.json file.</p>\n<p>In loose mode, TypeScript can be freely intermixed with untyped javascript and the compiler will do a best-effort to detect as many type violations as it can, and embrace all untyped data as <a target=\"_blank\" href=\"https://www.typescriptlang.org/docs/handbook/basic-types.html#any\">“any”</a> type which is simply not type-checked.</p>\n<p>For example given the following definition:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f594871222478\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f594871222478-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f594871222478-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f594871222478-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f594871222478-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f594871222478-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">fn</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f594871222478-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0026 seconds] -->\n<p></p>\n<p>Compiler infers the type of fn as follows:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5a1844137640\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a1844137640-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a1844137640-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a1844137640-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5a1844137640-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a1844137640-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> fn:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">any</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a1844137640-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>So all that the TypeScript compiler knows about fn is that it is a function and that it takes two arguments. There is no type safety around the parameters, so the compiler will happily accept a usage like:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5a5704502907\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a5704502907-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a5704502907-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a5704502907-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5a5704502907-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a5704502907-2\"><span class=\"crayon-e\">fn</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a5704502907-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0004 seconds] -->\n<p></p>\n<p>We also see that <code>any</code> is <strong>contagious</strong>. Given that the parameters are untyped, any results that depend on these parameters also has <code>any</code> type.</p>\n<p>In strict mode, the compiler will warn when variables end up with <code>any</code> type implicitly. But still, the developer has enough flexibility to explicitly use <code>any</code> whenever they see fit.</p>\n<p>There is also a <a target=\"_blank\" href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-6.html#suppress-errors-in-ts-files-using--ts-ignore-comments\"><code>@ts-ignore</code></a> pragma which simply disables type checking for annotated sections of code.</p>\n<p>This can be somewhat advantageous wrt. interoperability because many prevalent javascript usage patterns can not be easily type-checked by the compiler and typescript intends to be a javascript superset so it has to accomodate for all kinds of dynamic and stringly typed APIs.</p>\n<p>Example from <a target=\"_blank\" href=\"https://lodash.com/\">lodash library</a>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5a8729342567\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a8729342567-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a8729342567-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a8729342567-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a8729342567-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a8729342567-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a8729342567-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5a8729342567-7\">7</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5a8729342567-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a8729342567-2\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">object</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'a'</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'b'</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'c'</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a8729342567-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a8729342567-4\"><span class=\"crayon-v\">_</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">set</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">object</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'a[0].b.c'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a8729342567-5\"><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">object</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">b</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">c</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a8729342567-6\"><span class=\"crayon-c\">// =&gt; 4</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5a8729342567-7\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0012 seconds] -->\n<p></p>\n<p>If we look at the <a target=\"_blank\" href=\"https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/lodash/common/object.d.ts#L3110-L3124\">type definition</a> for <code>set</code>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5ab765923154\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ab765923154-17\">17</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-2\"><span class=\"crayon-c\">/**</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-3\"><span class=\"crayon-c\"> * Sets the value at path of object. If a portion of path doesn’t exist it’s created. Arrays are created for</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-4\"><span class=\"crayon-c\"> * missing index properties while objects are created for all other missing properties. Use _.setWith to</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-5\"><span class=\"crayon-c\"> * customize path creation.</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-6\"><span class=\"crayon-c\"> *</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-7\"><span class=\"crayon-c\"> * @param object The object to modify.</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-8\"><span class=\"crayon-c\"> * @param path The path of the property to set.</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-9\"><span class=\"crayon-c\"> * @param value The value to set.</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-10\"><span class=\"crayon-c\"> * @return Returns object.</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-11\"><span class=\"crayon-c\"> */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-12\"><span class=\"crayon-e\">set</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">object</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">path</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">PropertyPath</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">value</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">any</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-16\"><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ab765923154-17\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p>TypeScript will not make an attempt to validate that after setting the value, whether or not the resultant object still complies with the interface <code>T</code> and will just <i>assume</i> that it will.</p>\n<p>OCaml was designed to be a strongly typed language from the get go, and does not allow these kind of leeways. The type system is intentionally <a target=\"_blank\" href=\"http://papl.cs.brown.edu/2014/safety-soundness.html\">sound</a> and type coverage is <strong>guaranteed</strong> to be 100%.</p>\n<p>For interop, BuckleScript compiler supports typed externals which act as type hints for the compiler and are erased afterwards. Examples from <a target=\"_blank\" href=\"https://bucklescript.github.io/docs/en/bind-to-global-values.html\">BuckleScript docs</a>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5af992797728\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5af992797728-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5af992797728-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5af992797728-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5af992797728-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5af992797728-2\"><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">bs</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">val</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">external </span><span class=\"crayon-r\">clearTimeout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">float</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">unit</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5af992797728-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0007 seconds] -->\n<p></p>\n<p>As a “last-resort escape hatch” <a target=\"_blank\" href=\"https://bucklescript.github.io/docs/en/embed-raw-javascript.html\">embedding “raw” untyped javasacript</a> is also possible.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5b2479451320\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b2479451320-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b2479451320-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b2479451320-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b2479451320-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b2479451320-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5b2479451320-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b2479451320-2\"><span class=\"crayon-v\">Js</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"this is reason\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b2479451320-3\"><span class=\"crayon-i\">let</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-o\">%</span><span class=\"crayon-v\">bs</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">raw</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'here is a string from javascript'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b2479451320-4\"><span class=\"crayon-v\">Js</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\" back in reason land\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* ++ is the operator for string concat */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b2479451320-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n<p>The type of <code>x</code> here is akin to <code>any</code> in typescript which “unifies with everything”, and is highly discouraged.</p>\n<p>It is recommended that whenever javascript values are pulled in from the “unsafe world”, they are explicitly typed at the interop boundaries so that type safety is not compromised.</p>\n<p>TypeScript also supports a zero-commitment opt-in type checking through <a target=\"_blank\" href=\"https://github.com/Microsoft/TypeScript/wiki/JSDoc-support-in-JavaScript\">type annotations in comments</a>.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5b5051085456\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b5051085456-19\">19</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-3\"><span class=\"crayon-c\">/**</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-4\"><span class=\"crayon-c\"> * @typedef {Object} CustomType - Declares a type named 'CustomType'</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-5\"><span class=\"crayon-c\"> * @property {string} prop1 - a string property of CustomType</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-6\"><span class=\"crayon-c\"> * @property {number} prop2 - a number property of CustomType</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-7\"><span class=\"crayon-c\"> * @prop {number} [prop5=10] - an optional number property of CustomType with default value</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-8\"><span class=\"crayon-c\"> */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-9\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-10\"><span class=\"crayon-c\">/**</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-11\"><span class=\"crayon-c\"> * @param {CustomType} p1- A string param declared using TS-style</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-12\"><span class=\"crayon-c\"> * @param {string}&nbsp;&nbsp;p2 - A string argument.</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-13\"><span class=\"crayon-c\"> * @param {string=} p3 - Optional argument</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-14\"><span class=\"crayon-c\"> * @return {string}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-15\"><span class=\"crayon-c\"> */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-16\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">fn</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">p1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p3</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-17\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-c\">// TODO</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-18\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b5051085456-19\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0007 seconds] -->\n<p></p>\n<p>This is advantageous for large javascript projects to ease gradual migration to typescript. And also when a compilation step is not desirable.<br>\nHowever, as with all solutions which abuse comments for purposes other than commenting, this is prone to human errors eg. typos in your type declarations may end up getting ignored by the compiler etc.</p>\n<p>In contrast, Reason enthusiasts take the stance that you really value type safety and so are willing to make the commitment and opt into an entirely different language.</p>\n<h2>Type inference</h2>\n<p>OCaml is quite famous for its <a target=\"_blank\" href=\"http://www.cs.cornell.edu/courses/cs3110/2011fa/supplemental/lec26-type-inference/type-inference.htm\">sophisticated type inference</a>, and is much better at this than typescript. When starting out, type inference in Reason can feel almost magical.</p>\n<p>In the code below:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5b9862564727\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5b9862564727-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">person</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-5\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-7\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">printName</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Js</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">name</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5b9862564727-8\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<p></p>\n<p>The printName function can infer the type of p based on its usage within the function body.</p>\n<p><img loading=\"lazy\" class=\"alignnone size-full wp-image-195\" src=\"/wp-content/uploads/2018/05/Screenshot-from-2018-05-14-00-56-29.png\" alt=\"\" width=\"417\" height=\"164\" srcset=\"/wp-content/uploads/2018/05/Screenshot-from-2018-05-14-00-56-29.png 417w, /wp-content/uploads/2018/05/Screenshot-from-2018-05-14-00-56-29-300x118.png 300w\" sizes=\"(max-width: 417px) 100vw, 417px\"></p>\n<p>In contrast, TypeScript infers all untyped function arguments as <code>any</code>.</p>\n<p>Inference can be nice, but in case of type mismatch, the errors can sometimes be misleading wrt. whether the error is at call site or the definition site.</p>\n<p>In last year or so, there has not been a single occurance where I have encountered a TypeScript error and have not been able to comprehend within 5 mins what the error exactly is.</p>\n<h2>Type directed emit</h2>\n<p>One of the primary design decisions of typescript is to avoid type directed emit. From <a target=\"_blank\" href=\"https://github.com/Microsoft/TypeScript/wiki/TypeScript-Design-Goals\">Non-goals section</a>:</p>\n<blockquote><p>[TS will not] Add or rely on run-time type information in programs, or emit different code based on the results of the type system. Instead, encourage programming patterns that do not require run-time metadata.</p></blockquote>\n<p>The consequence of this is that the generated javascript is fairly close to handwritten idiomatic javascript. This also has advantage in that opting out of TypeScript is relatively easy.</p>\n<p>Reason (or rather BuckleScript) has no such qualms. A lot of optimization efforts have gone into BuckleScript to fully utilize the type system and take advantage of compiler’s intelligence to generate tiny compilation outputs.</p>\n<p>In contrast TypeScript explicitly states that aggressive optimization is <strong>not</strong> one of compiler’s goals. From the Non-goals section in the roadmap:</p>\n<blockquote><p>[TS will not] Aggressively optimize the runtime performance of programs. Instead, emit idiomatic JavaScript code that plays well with the performance characteristics of runtime platforms.</p></blockquote>\n<p>It is to be noted though, that statically analyzable code can often be better optimized by the JIT compiler or optimizers like <a target=\"_blank\" href=\"http://lisperator.net/uglifyjs/\">UglifyJS</a> or <a target=\"_blank\" href=\"https://developers.google.com/closure/compiler/\">Google Closure</a>.</p>\n<p>An example of reason’s optimization can be seen in how it implements records:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5bd697202119\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5bd697202119-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">person</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-5\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-7\"><span class=\"crayon-i\">let</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"john\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5bd697202119-8\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0010 seconds] -->\n<p></p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5c0005012912\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c0005012912-13\">13</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-2\"><span class=\"crayon-c\">// Generated by BUCKLESCRIPT VERSION 3.0.1, PLEASE EDIT WITH CARE</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-3\"><span class=\"crayon-s\">'use strict'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-5\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-6\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* record */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-7\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-c\">/* age */</span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-c\">/* name */</span><span class=\"crayon-s\">\"john\"</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-9\"><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-11\"><span class=\"crayon-v\">exports</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-12\"><span class=\"crayon-c\">/* No side effect */</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c0005012912-13\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p>One might have expected the person type to be represented as a javascript class, but the compiler optimizes away the record type entirely and leaves behind a compact array.</p>\n<p>The negative side of this is that there it is that scope of runtime reflection is severly limited. Runtime reflection is typically not idiomatic in OCaml. The metaprogramming section below touches upon some of the alternatives.</p>\n<h2>Functional Programming</h2>\n<p>Javascript has many functional features, primary among them is support for <a target=\"_blank\" href=\"https://www.sitepoint.com/higher-order-functions-javascript/\">higher order functions</a>. These features carry over seamlessly in TypeScript. TypeScript’s type system handles higher order functions etc. quite well, but besides that it does little on top to encourage functional programming.</p>\n<p>There are many <a target=\"_blank\" href=\"https://hackernoon.com/functional-programming-in-javascript-is-an-antipattern-58526819f21e\">caveats</a> of functional programming in javascript, primary among them is that the built-in data structures are not really designed with immutability in mind.</p>\n<p>Adopting immutability in javascript boils down to one of these two options:</p>\n<ol>\n<li>We can use helper libraries to operate on native data structures without mutations. This often requires unnecessary cloning though, and is, in general, not particularly efficient.<p></p>\n</li>\n<li>\n<p>We can use something like <a target=\"_blank\" href=\"https://facebook.github.io/immutable-js/\">ImmutableJS</a>, but most libraries accept native arrays and objects, in such cases cost of coverting to and from and immutable can add up significantly.</p>\n</li>\n</ol>\n<p>Also, while functional composition is possible, the language could certainly benefit from more syntax sugar to make operations on functions as succinct as operations on primitives.</p>\n<p>Reason has been designed with functional programming at its core. Though it has some <a target=\"_blank\" href=\"https://realworldocaml.org/v1/en/html/objects.html\">object oriented features</a>, it is primarily a functional language.</p>\n<p>Primary built-in data structures are immutable, so it can be expected that all reason libraries play well with them. This includes lists, records, tuples etc. Remember that we said above that Reason’s built in data structures may quack like Javascript but have different semantics ?</p>\n<p>BuckleScript has a number of optimizations in place to make operations on immutable entities performant.</p>\n<p>Mutability is <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/mutation.html\">opt in</a> and explicit (through usage of ref cells).</p>\n<p>A few primary features of ReasonML that aid in functional programming are highlighted below. The <a target=\"_blank\" href=\"http://2ality.com/2017/12/functions-reasonml.html#the-reverse-application-operator\">2ality blog</a> by Axel Rauschmayer already introduces them very well, so I will defer to that post for elaborations.</p>\n<h3>Curried functions</h3>\n<p>Reason functions are <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Currying\">curried</a> by default. While this may seem weird to javascript developers (or developers from object oriented language backgrounds), this is really common in functional world, and partial application is quite common in practice. Hugh Jackson has written a <a target=\"_blank\" href=\"https://hughfdjackson.com/javascript/why-curry-helps/\">great post</a> on the advantages of currying.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5c5834576184\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c5834576184-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c5834576184-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c5834576184-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c5834576184-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c5834576184-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5c5834576184-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c5834576184-2\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">incrementAgeBy</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">count</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">age</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">count</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c5834576184-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c5834576184-4\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">incrementAgeBy1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c5834576184-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>FP enthusiasts have long advocated for currying in javascript and libraries like <a target=\"_blank\" href=\"/2018/05/13/reasonml-vs-typescript-first-impressions/ramdajs.com\">Ramda</a> have embraced it throughout their API.</p>\n<p>BuckleScript optimizes curried functions to prevent unnecessary use of closures wherever possible:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5c8005060712\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5c8005060712-10\">10</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">person</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-5\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-7\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">incrementAgeBy</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">count</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">age</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">count</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-9\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">incrementAgeBy1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5c8005060712-10\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0014 seconds] -->\n<p></p>\n<p>Compiles to:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5cb919574988\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5cb919574988-12\">12</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-2\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">count</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* record */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* age */</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">[</span><span class=\"crayon-c\">/* age */</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">count</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* name */</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">[</span><span class=\"crayon-c\">/* name */</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-7\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-9\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy1</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">param</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">param</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-11\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5cb919574988-12\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0013 seconds] -->\n<p></p>\n<p>So when <code>incrementAgeBy</code> is called with two arguments there is no overhead.</p>\n<p>Side effect of implicit currying is that, in Reason we don’t have functions with <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Variadic_function\">variadic arguments</a>, which is very common in javascript.<br>\nTypeScript supports variadic arguments of same type, but the only way to handle heterogenous variadic arguments is through any.</p>\n<p>It is a common practice among libraries to handle few arities with generic types and falling back to <code>any</code> for higher index arities.</p>\n<p>Example from <a target=\"_blank\" href=\"https://unpkg.com/mobx-state-tree@2.0.5/dist/utils.d.ts\">MobX state tree</a></p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5ce219092526\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ce219092526-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ce219092526-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ce219092526-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ce219092526-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ce219092526-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ce219092526-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5ce219092526-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ce219092526-2\"><span class=\"crayon-e\">export </span><span class=\"crayon-r\">declare</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">extend</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">A</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ce219092526-3\"><span class=\"crayon-e\">export </span><span class=\"crayon-r\">declare</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">extend</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">A</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">C</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">c</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">C</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">C</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ce219092526-4\"><span class=\"crayon-e\">export </span><span class=\"crayon-r\">declare</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">extend</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">A</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">C</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">D</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">c</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">C</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">d</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">D</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">B</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">C</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">D</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ce219092526-5\"><span class=\"crayon-e\">export </span><span class=\"crayon-r\">declare</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">extend</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">a</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">b</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ce219092526-6\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0031 seconds] -->\n<p></p>\n<p>Currying also encourages “data-last signatures” where the primary subject of the operation is the last argument.</p>\n<p>For cases, where is this is not adequate, Reason also supports <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/function.html#labeled-arguments\">labeled arguments</a>. Labeled arguments also aid towards readability and while a similar thing can be emulated in javascript through object arguments and destructuring, in case of labeled arguments there is no overhead of an additional object allocation.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5d2164405679\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d2164405679-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d2164405679-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d2164405679-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d2164405679-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d2164405679-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5d2164405679-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d2164405679-2\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">incrementAgeBy</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">~</span><span class=\"crayon-v\">count</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">~</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">age</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">count</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d2164405679-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d2164405679-4\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">incrementAgeBy1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">~</span><span class=\"crayon-v\">count</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d2164405679-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0011 seconds] -->\n<p></p>\n<p>Compiles to:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5d4407389347\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d4407389347-12\">12</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-2\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">count</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* record */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* age */</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">[</span><span class=\"crayon-c\">/* age */</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">count</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* name */</span><span class=\"crayon-v\">p</span><span class=\"crayon-sy\">[</span><span class=\"crayon-c\">/* name */</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-7\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-9\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy1</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">param</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">incrementAgeBy</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">param</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-11\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d4407389347-12\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0014 seconds] -->\n<p></p>\n<h3>Operators as functions.</h3>\n<p>Unlike javascript and typescript, OCaml offers <a target=\"_blank\" href=\"http://2ality.com/2017/12/functions-reasonml.html#operators\">custom operators</a>. Operators are essentially functions with syntax sugar for infix/prefix usage.</p>\n<p>When misused this can make code a <b>lot</b> more difficult to grok, but for commonly used patterns it can help towards reducing unnecessary verbosity in code. This can also aid towards embedded <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Domain-specific_language\">DSL</a>s.</p>\n<h3>Pipe Operator</h3>\n<p>ReasonML supports a pipe operator for <a target=\"_blank\" href=\"http://2ality.com/2017/12/functions-reasonml.html#the-reverse-application-operator\">reverse application</a> of functions.</p>\n<p>Example from the linked post from 2ality blog:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5d8189347180\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d8189347180-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d8189347180-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d8189347180-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d8189347180-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5d8189347180-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5d8189347180-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d8189347180-2\"><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d8189347180-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">List</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">map</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d8189347180-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">List</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">filter</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">List</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">sort</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">compare</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5d8189347180-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0013 seconds] -->\n<p></p>\n<p>This makes chaining of operations very easy to grok and helps with functional data transformation pipelines. As should be obvious from the example above, reverse application naturally fits in with support for punning and currying.</p>\n<p>There are currently two <a target=\"_blank\" href=\"https://github.com/tc39/proposal-pipeline-operator/wiki\">competing proposals</a> for incorporation of pipe operator in javascript and respective champions are currently debating whether to make this more similar to flow or hack. TypeScript support for this is nowhere to be seen yet.</p>\n<h3>Pattern Matching</h3>\n<p><a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/pattern-matching.html\">Pattern Matching</a> is the crown jewel of ML. It is amazingly flexible, widely used and results in very clean code. This also goes hand in hand with <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/destructuring.html\">destructuring support</a>. It is not a coincidence that the single most prominent code example in Reason home page illustrates pattern matching:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5db404443103\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5db404443103-11\">11</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-2\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">schoolPerson</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Teacher</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Director</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Student</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-4\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">greeting</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">stranger</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">switch</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">stranger</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Teacher</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Hey professor!\"</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-7\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Director</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Hello director.\"</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Student</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Richard\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Still here Ricky?\"</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-9\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Student</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">anyOtherName</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Hey, \"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">anyOtherName</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\".\"</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5db404443103-11\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0018 seconds] -->\n<p></p>\n<p>If you have ever used convoluted nested if-else conditionals and have wondered if there could be a better construct, which could support a lower boilerplate unified syntax for branching based on type of the subject, or a member of a collection, or a property of a record — well that is what pattern matching is, and it is available in all its glory in ReasonML right now.</p>\n<p>As is to be expected, there is also <a target=\"_blank\" href=\"https://github.com/tc39/proposal-pattern-matching\">a proposal</a> for incorporating pattern matching in javascript. Once again, given the stage 0 status, TypeScript support is nowhere to be seen yet.</p>\n<p>Pattern matching and algebraic data types go <a href=\"https://haifengl.wordpress.com/2014/07/07/ocaml-algebraic-data-types/\" target=\"_blank\">hand in hand</a>.</p>\n<h2>Asynchronous Programming</h2>\n<p>It is fairly easy to use callbacks and promises when interoperating with javascript code. BuckleScript already provides bindings to <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/promise.html\">javascript promises</a>.</p>\n<p>TypeScript has had, for a long time, first class support for ES7 <a target=\"_blank\" href=\"https://javascript.info/async-await\">async/await keywords</a>. There have been <a target=\"_blank\" href=\"https://jaredforsyth.com/posts/building-async-await-in-reason/\">some attempts</a> to rebuild similar support in Reason in Reason, but as the author has highlighted in the linked post, the flexibility of javascript promises makes exact emulation of async/await difficult to play well with Reason’s strict typesystem.</p>\n<p>The good news is that since all Javascript async APIs use promises as the foundational abstractions, interop through Promises is quite easy.</p>\n<h2>The various flavors of object types</h2>\n<p>Typescript embraces <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Structural_type_system\">structural typing</a> which is a natural fit for interoperating with a dynamic language. Jamie Kyle has provided a <a target=\"_blank\" href=\"https://medium.com/@thejameskyle/type-systems-structural-vs-nominal-typing-explained-56511dd969f4\">good introduction</a> on the differences between Structural and Nominal type systems.</p>\n<p>TypeScript’s interfaces are amazingly flexible and easy to understand. Along with <a target=\"_blank\" href=\"http://www.typescriptlang.org/docs/handbook/advanced-types.html\">Union and Intersection</a> types, they offer a wide berth for modelling polymorphic behavior. And they can be used to model almost all statically analysable usage patterns in javascript.</p>\n<p>In contrast, in Reason we have Records (<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Nominal_type_system\">nominally typed</a>), Objects (structurally typed) and BuckleScript’s wrapped Objects which have different semantics.</p>\n<p>While records are much faster implementation wise, they are rigidly typed: The types have to be declared beforehand and there is little support for deriving record types from other record types. The differences and subtly different syntax of these can be very confusing when starting out. We have already seen usage of Records in previous parts of this article and observed that BuckleScript compiles them away to compact arrays.</p>\n<p>So now the question arises, what if you really need a javascript object ? What if we want to have methods with a shared context (this in javascript) ?</p>\n<p>That is where the object type comes into picture. Before we get into them, let us try to identify two common usage patterns around objects in javascript :</p>\n<h3>Objects as Maps vs Objects as Records</h3>\n<p>In javascript, the enormous flexibility of objects have lent them to be used as both dictionaries (A collection of arbitrary key to value mappings) as well as Records (Mapping from fixed set of keys to values of priorly known types).</p>\n<p>TypeScript handles the former case through interfaces having a <a target=\"_blank\" href=\"http://www.typescriptlang.org/docs/handbook/advanced-types.html#index-types-and-string-index-signatures\">string index signature:</a></p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5e1191156502\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e1191156502-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e1191156502-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e1191156502-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e1191156502-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e1191156502-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5e1191156502-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e1191156502-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Map</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e1191156502-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">key</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e1191156502-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e1191156502-5\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>and the latter case through explicitly typed interface properties:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5e3413977136\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e3413977136-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e3413977136-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e3413977136-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e3413977136-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e3413977136-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e3413977136-6\">6</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5e3413977136-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e3413977136-2\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e3413977136-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e3413977136-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">integer</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e3413977136-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e3413977136-6\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>It is easily possible and common to mix and match these two usage patterns.</p>\n<p>BuckleScript strives to clearly distinguish between these two usage patterns. For dictionary style usage, <a target=\"_blank\" href=\"https://bucklescript.github.io/docs/en/object.html#object-as-hash-map\">JS.Dict</a> is preferred. And for Record style usage BuckleScript provides a wrapper to be used in conjuction with Object types.</p>\n<h2>ReasonML Object Type</h2>\n<p>To see an example of object types, let us look an a translated example of stack object type from <a target=\"_blank\" href=\"https://realworldocaml.org/v1/en/html/objects.html#ocaml-objects\">Real world OCaml</a>:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5e6607917240\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5e6607917240-15\">15</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-1\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">stack</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">init</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">val </span><span class=\"crayon-i\">mutable</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">v</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">init</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">pub </span><span class=\"crayon-v\">pop</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">switch</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">v</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">hd</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">tl</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">v</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tl</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">Some</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">hd</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">None</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">pub </span><span class=\"crayon-v\">push</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">hd</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">v</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">hd</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">v</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-11\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-13\"><span class=\"crayon-i\">let</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">stack</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-14\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5e6607917240-15\"><span class=\"crayon-v\">s</span><span class=\"crayon-o\">#</span><span class=\"crayon-v\">pop</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0023 seconds] -->\n<p></p>\n<p>Note that we didn’t have to declare the type of the return value of stack beforehand. Objects are less rigidly typed in this regard wrt. records.</p>\n<p>If we look at the inferred type of <code>s</code>, there is something interesting to be observed:</p>\n<p><img loading=\"lazy\" class=\"alignnone size-full wp-image-196\" src=\"/wp-content/uploads/2018/05/Screenshot-from-2018-05-14-01-23-57.png\" alt=\"\" width=\"663\" height=\"71\" srcset=\"/wp-content/uploads/2018/05/Screenshot-from-2018-05-14-01-23-57.png 663w, /wp-content/uploads/2018/05/Screenshot-from-2018-05-14-01-23-57-300x32.png 300w\" sizes=\"(max-width: 663px) 100vw, 663px\"></p>\n<p>No, the dot after the curly brace is not an error and that is how Reason distinguishes between Record Type and Object Types. Don’t you love the syntax already ?</p>\n<p>The compiled output for this might be very surprising:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5ea108400493\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-21\">21</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-23\">23</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-25\">25</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-27\">27</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-29\">29</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-31\">31</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-33\">33</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-34\">34</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-35\">35</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-36\">36</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-37\">37</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-38\">38</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-39\">39</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-40\">40</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-41\">41</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-42\">42</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-43\">43</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-44\">44</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-45\">45</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-46\">46</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-47\">47</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-48\">48</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-49\">49</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-50\">50</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-51\">51</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-52\">52</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-53\">53</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-54\">54</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-55\">55</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-56\">56</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-57\">57</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-58\">58</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-59\">59</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-60\">60</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-61\">61</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-62\">62</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-63\">63</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-64\">64</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-65\">65</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-66\">66</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-67\">67</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-68\">68</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-69\">69</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-70\">70</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-71\">71</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-72\">72</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-73\">73</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-74\">74</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5ea108400493-75\">75</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-1\"><span class=\"crayon-c\">// Generated by BUCKLESCRIPT VERSION 3.0.1, PLEASE EDIT WITH CARE</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-2\"><span class=\"crayon-s\">'use strict'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-3\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-4\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Curry</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"stdlib/curry\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-5\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Caml_oo_curry</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"stdlib/caml_oo_curry\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-6\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">CamlinternalOO</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"stdlib/camlinternalOO\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-8\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">shared</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-9\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-s\">\"push\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-s\">\"pop\"</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-11\"><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-13\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">class_tables</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-14\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-15\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-16\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-17\"><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-18\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-19\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">stack</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">init</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-20\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">!</span><span class=\"crayon-v\">class_tables</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">$</span><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">CamlinternalOO</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">create_table</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">shared</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-22\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ids</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">CamlinternalOO</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">new_methods_variables</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">$</span><span class=\"crayon-t\">class</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">shared</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"v\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-23\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">push</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ids</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-24\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pop</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ids</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-25\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">v</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ids</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-26\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">CamlinternalOO</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">set_methods</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">$</span><span class=\"crayon-t\">class</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* array */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-27\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">pop</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-28\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">27</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-29\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">match</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">27</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">v</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-30\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">match</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-31\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">27</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">v</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">match</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-32\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* Some */</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">match</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-33\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-34\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* None */</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-35\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-36\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-37\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">push</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-38\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">27</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">hd</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-39\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">27</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">v</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* :: */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-40\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">hd</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-41\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">$</span><span class=\"crayon-cn\">27</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">v</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-42\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-43\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">/* () */</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-44\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-45\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-46\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">env_init</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">env</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-47\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">self</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">CamlinternalOO</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">create_object_opt</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">$</span><span class=\"crayon-t\">class</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-48\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">v</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">env</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-49\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">self</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-50\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-51\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">CamlinternalOO</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">init_class</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">$</span><span class=\"crayon-t\">class</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-52\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">class_tables</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">env_init</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-53\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-54\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Curry</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">_1</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">class_tables</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-55\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-56\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-i\">init</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-57\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-58\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-59\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-60\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">stack</span><span class=\"crayon-sy\">(</span><span class=\"crayon-c\">/* :: */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-61\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-62\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* :: */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-63\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-64\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* :: */</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-65\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-66\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/* [] */</span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-67\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-68\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-69\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-70\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-71\"><span class=\"crayon-v\">Caml_oo_curry</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">js1</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">5594513</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-72\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-73\"><span class=\"crayon-v\">exports</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">stack</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">stack</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-74\"><span class=\"crayon-v\">exports</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5ea108400493-75\"><span class=\"crayon-c\">/* s Not a pure module */</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0116 seconds] -->\n<p></p>\n<p>What has happened here is that Object Orientation in OCaml follows very different semantics than javascript’s prototypal inheritance, and BuckleScript by default uses an implementation that is faithful to native OCaml semantics.</p>\n<p>However most of the time, when in javascript world, we would want to use javascript objects, and for that BuckleScript provides a <a target=\"_blank\" href=\"https://bucklescript.github.io/docs/en/object.html#object-as-record\">wrapped object type</a>&nbsp;which compile to javascript objects.</p>\n<p>While the linked BuckleScript docs cover wrapped object type in detail, I want to highlight the syntax sugar provided by Reason to sweeten the usage of BuckleScript’s wrapped object type :</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5f0782598292\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f0782598292-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f0782598292-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f0782598292-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5f0782598292-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f0782598292-2\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">jane</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f0782598292-3\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0005 seconds] -->\n<p></p>\n<p>The above is a valid code and compiles to exactly what you’d expect:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5f3007452079\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f3007452079-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f3007452079-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f3007452079-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f3007452079-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f3007452079-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5f3007452079-1\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">jane</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f3007452079-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f3007452079-3\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f3007452079-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f3007452079-5\"><span class=\"crayon-v\">exports</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">jane</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">jane</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0006 seconds] -->\n<p></p>\n<p>Note that unlike JavaScript/TypeScript, the quotes here are significant (Otherwise it would be treated as a Record). Remember I noted above that syntactic similarities are only skin deep ?</p>\n<p>If we want this object to be explicitly typed, we can specify the object type as follows:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5f6101334644\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f6101334644-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f6101334644-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f6101334644-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f6101334644-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5f6101334644-5\">5</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5f6101334644-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">person</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Js</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">t</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f6101334644-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f6101334644-3\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f6101334644-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5f6101334644-5\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">jane</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">person</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0007 seconds] -->\n<p></p>\n<p>At this point I guess the <code>&#123;.</code> seems quite intuitive. No ? Oh well …</p>\n<p>When it is at all not possible to fit usage of objects into one of the above two usage patterns, there is also support for a more <a target=\"_blank\" href=\"https://bucklescript.github.io/docs/en/object.html#object-as-dynamic-record\">dynamic usage pattern</a> which is generally discouraged.</p>\n<h2>Modules</h2>\n<p>ES6 Modules are very different from how most languages implement module systems. For the most part, I am a big fan of the one-to-one correlation between modules and files.</p>\n<p>I am also a big fan of explicit imports in ES6 as they make it very easy to follow through logic when doing code reviews in github.</p>\n<p>The typescript tooling is so good at this point, that I rarely have to write imports by hand. I can, in almost 100% cases, rely on typescript language server to identify and inject imports in source files and I heavily rely on tools for most of my refactoring.</p>\n<p>Reason/OCaml modules are much much different and in <i>some</i> ways more advanced.</p>\n<p>Modules are identified and referenced by names and not by relative paths to modules.</p>\n<p>While every file implicitly does define its own module, files can have many explicitly defined modules as well.</p>\n<p>In case of implicitly defined modules, the module name is derived from the name of the module. The location of the file in the filesystem hierarchy is insignificant and files can be moved around without needing any refactoring. This implies that verbose file names are quite common.</p>\n<p>As <a target=\"_blank\" href=\"https://blog.janestreet.com/better-namespaces-through-module-aliases/\">explained</a> by Yaron Minskey :</p>\n<blockquote><p>In particular OCaml has no good way of organizing modules into packages. One sign of the problem is that you can’t build an executable that has two modules with the same module name. This is a pretty awkward restriction, and it gets unworkable pretty fast as your codebase gets bigger</p></blockquote>\n<p>The post linked above recommends using module aliases as a namespacing alternative.</p>\n<p>OCaml is fairly unique in its support of <a target=\"_blank\" href=\"https://www.cs.cornell.edu/courses/cs3110/2017fa/l/08-functors/notes.html\">parameterized modules or Functors</a> which can significantly aid in type-safe code reuse and can serve as foundation for sophisticated abstractions. Fuctors is a fairly large topic in itself and deserves a dedicated post in this blog, which will follow in near future.</p>\n<p>As the <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/module.html\">official documentation</a> explains:</p>\n<blockquote><p>Modules and functors are at a different “layer” of language than the rest. </p></blockquote>\n<p>Explicit modules are somewhat akin to TypeScript namespaces, but support for module parameterization does not have a direct equally powerful analogue in TypeScript.</p>\n<h2>Meta programming</h2>\n<p>The work around <a target=\"_blank\" href=\"http://ocamllabs.io/doc/ppx.html\">ppx</a> is arguably one of the most interesting aspects of the OCaml ecosystem.</p>\n<p>Quoting from the linked site:</p>\n<blockquote><p>The PPX language feature provides a new API for syntactic extensions in OCaml. PPX uses attributes to allow type-driven code generation, extension nodes for custom constructs and quoted strings for insertion of code fragments in unrelated syntax</p></blockquote>\n<p>TypeScript has a <a target=\"_blank\" href=\"https://github.com/Microsoft/TypeScript/wiki/Using-the-Compiler-API#creating-and-printing-a-typescript-ast\">compiler API</a> to support similar use cases which facilitates programmatic AST traversal and manipulation. However, as of this writing, this is marked as experimental and is not as mature.</p>\n<p>TypeScript also has experimental support for exposing design time type information at runtime through <a target=\"_blank\" href=\"http://blog.wolksoftware.com/decorators-metadata-reflection-in-typescript-from-novice-to-expert-part-4\">metadata reflection</a> which facilitates runtime metaproramming.</p>\n<h2>JSX</h2>\n<p>Given that Reason is by facebook, it is no surprise that their love of embedded XML-ish DSL carries over (from <a target=\"_blank\" href=\"https://reactjs.org/docs/introducing-jsx.html\">JSX</a>, <a target=\"_blank\" href=\"https://www.facebook.com/notes/facebook-engineering/xhp-a-new-way-to-write-php/294003943919/\">XHP</a> etc.) and thus Reason is blessed with a similar dedicated <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/jsx.html\">syntax sugar</a>.</p>\n<p>There are <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/jsx.html#departures-from-js-jsx\">subtle differences</a> from what happens in javascript, esp. punning, but overall the superfluous verbosity of the XML inspired DSL disgusts me in either languages, so not much to add here.</p>\n<h2>Interop</h2>\n<p>Bucklescript has a <a target=\"_blank\" href=\"https://bucklescript.github.io/docs/en/interop-overview.html\">dedicated section</a> on Interop which covers most use cases. But the tl;dr is that while unlike TypeScript not all javascript dynamic usage patterns can be expressed directly in OCaml. But through BuckleScript’s embedded javascript support it is possible to drop down to untyped javascript and wrap such usages and expose them in a type safe manner.</p>\n<p>Bucklescript’s interop support is somewhere between Elm’s <a target=\"_blank\" href=\"https://guide.elm-lang.org/interop/javascript.html\">port system</a> (which is the most tedious of all interop solutions I have encountered) and TypeScript which is happy to let you intermix untyped and typed javascript code.</p>\n<p>However this also implies that Bucklescript can’t make strong guarantees about <a target=\"_blank\" href=\"https://www.infoq.com/news/2017/05/elm-zero-runtime-exception\">zero runtime errors</a> as Elm can. Of course, TypeScript’s unsound type system has never had any such guarantees and nor is this planned as per their Roadmap.</p>\n<h2>Caveats around esoteric syntax</h2>\n<p>Javascript is well know to have many <a target=\"_blank\" href=\"https://medium.com/dailyjs/the-why-behind-the-wat-an-explanation-of-javascripts-weird-type-system-83b92879a8db\">“warts”</a> around its weak typing.</p>\n<p>OCaml’s type system may be safe and sound, but it has its own set of quirks. Many of these bizarre syntax rules have been <a target=\"_blank\" href=\"https://reasonml.github.io/docs/en/comparison-to-ocaml.html\">“unified”</a> by Reason’s syntax sugar. However some of them are very fundamentally rooted into the type system.</p>\n<p>We have already seen the <em>interesting </em>use of operators and quoting in objects above.&nbsp;One such quirk that is most commonly visible is that (as mentioned above) operators are just functions and functions don’t have method overloading so we must use different operators when operating on different types.</p>\n<p>For example we need different operators when doing operations on float and integers:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f5fc209261541\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5fc209261541-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5fc209261541-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5fc209261541-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f5fc209261541-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f5fc209261541-1\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba44837f5fc209261541-2\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">dist</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5fc209261541-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">sqrt</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">y</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f5fc209261541-4\">&nbsp;</div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p><code>*.</code>, <code>+.</code> are float multiplication and addition operators respectively.</p>\n<p>Adhoc polymorphism and typed languages have had a love hate relationship. Sophisticated type systems like Haskell handle them through features like Type Classes. Dynamic languages, well, have never had any problem with them because type safety is not a concern. OCaml does not have either of these so ad-hoc polymorphism is something of a pain point, which may be addressed in <a target=\"_blank\" href=\"https://discuss.ocaml.org/t/modular-implicits/144\">future</a>.</p>\n<p>The 2ality blog points out an <em>interesting</em> workaround for this by locally overriding the operators by opening a module that aliases the float operators:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba44837f600642736645\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba44837f600642736645-8\">8</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-1\"><span class=\"crayon-e\">module </span><span class=\"crayon-v\">FloatOps</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">let</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">+</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">+</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">let</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">*</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">*</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-4\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-5\"><span class=\"crayon-e\">let </span><span class=\"crayon-v\">dist</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">FloatOps</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">sqrt</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">y</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">y</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba44837f600642736645-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0015 seconds] -->\n<p></p>\n<p>So while TypeScript (being a superset) carries over the warts of javascript,&nbsp; ReasonML also brings in its own set of syntactic eccentricities from its OCaml lineage, some of which may be quite obscure and non-intuitive&nbsp;for frontend developers.</p>\n<h2>Ecosystem</h2>\n<p>Many libraries for frontend development are being written in TypeScript and for many more (varying quality of) type definitions are available in the <a target=\"_blank\" href=\"https://github.com/DefinitelyTyped/DefinitelyTyped\">Definitively Typed repository</a>.</p>\n<p>There is a similar initiative <a target=\"_blank\" href=\"https://github.com/rrdelaney/ReasonablyTyped\">Reasonably Typed</a> for Reason, but that is not yet as comprehensive as TypeScript.</p>\n<hr>\n<h2>Summary</h2>\n<p>This brings us to the end of this post. I hope that this post helps you evaluate the different set of trade offs around which TypeScript and Reason have been designed around and make an informed decision when faced with a choice.</p>\n<p>My familiarity with Reason is still very nascent, so please feel free to comment about anything I might have missed out or got wrong.</p>\n<h3>Key Takeaways</h3>\n<ul>\n<li>For experienced javascript developers, Reason’s learning curve may be quite steep given it is a different language with many different semantics. TypeScript in contrast has a comparatively shallow learning curve being a javascript superset.</li>\n<li>Deeply integrated features like pattern matching, currying, destructuring and custom operators make functional programming a much more pleasant experience than TypeScript</li>\n<li>Reason embraces immutability and while mutability is generally discouraged, it can be explicitly opted in.</li>\n<li>In contrast to TypeScript, Reason’s type system is sound and more strict and has much better type inference. However type inference can be a double edged sword wrt. readability of error messages</li>\n<li>While Reason has a strict and sound type system, BuckleScript provides many escape hatches to ease interoperability with untyped javascript code.</li>\n<li>Unlike TypeScript, Reason embraces type directed emit, and in many cases effectively levarges the information type system has to aggressively optimize the generated code</li>\n<li>There are some dynamic usage patterns which have no direct analogues in Reason, and in these cases interop can get tricky.</li>\n</ul>\n<h2>References:</h2>\n<ol>\n<li><a target=\"_blank\" href=\"https://reasonml.github.io/\">Reason Official Site</a> maintained by Facebook Team</li>\n<li><a target=\"_blank\" href=\"https://haifengl.wordpress.com/2014/07/08/ocaml-polymorphism/\">OCaml: Polymorphism</a> by Haifeng Li</li>\n<li><a target=\"_blank\" href=\"http://reasonmlhub.com/exploring-reasonml/\">Exploring ReasonML</a> by Axel Rauschmayer</li>\n<li><a target=\"_blank\" href=\"https://realworldocaml.org/\">Real World Ocaml</a> by Anil Madhavapeddy, Jason Hickey and Yaron Minsky.</li>\n<li><a target=\"_blank\" href=\"https://haifengl.wordpress.com/category/programming/ocaml/\">Posts on OCaml</a> by Haifeng Li</li>\n</ol>\n\n\n    ",
            "tags": [
                "Typescript",
                "ReasonML"
            ]
        },
        {
            "id": "https://lorefnon.me/2018/03/25/typescript-and-validations-at-runtime-boundaries/",
            "url": "https://lorefnon.me/2018/03/25/typescript-and-validations-at-runtime-boundaries/",
            "title": "Typescript and validations at runtime boundaries",
            "date_published": "2018-03-25T00:00:00.000Z",
            "content_html": "<link rel=\"stylesheet\" href=\"/css/crayon.min.css\" >\n<link rel=\"stylesheet\" href=\"/css/crayon-flatui-light.css\" >\n\n\n\n\t<p>Typescript team has <a href=\"https://github.com/Microsoft/TypeScript/issues/1573#issuecomment-68374376\">explicitly stated</a> that they don’t intend to extend typescript’s static type checking to the runtime.</p>\n<p><a href=\"https://github.com/Microsoft/TypeScript/wiki/TypeScript-Design-Goals\">Typescript Design Goals</a> lists the following in the section on Non-goals:</p>\n<blockquote><p>Add or rely on run-time type information in programs, or emit different code based on the results of the type system. Instead, encourage programming patterns that do not require run-time metadata.</p></blockquote>\n<p>While on one hand this design goal is advantageous in that the output generated by typescript is very close to what hand written javascript would have looked like. And the runtime cost of typescript remains close to zero, therefore adoption of typescript does not alter performance characteristics of an application.</p>\n<p>However, this also implies that for cases when static typing cannot help us we need to separately write validators using a validation library (eg. <a href=\"https://github.com/hapijs/joi\">Joi</a>) which has to be kept in sync with the typescript types.</p>\n<p>This post outlines an approach to eliminate this redundancy using the <a href=\"https://github.com/gcanti/io-ts\">io-ts</a> library by <a href=\"https://gcanti.github.io/about.html\">Giulio Canti</a>. This approach has also been adopted by some other libraries like <a href=\"https://github.com/mobxjs/mobx-state-tree\">MobX State Tree</a> and <a href=\"https://github.com/pelotom/runtypes\">Runtypes</a>.</p>\n<p><span id=\"more-150\"></span></p>\n<h2>Runtime Boundaries</h2>\n<p>Runtime boundaries are cases where some untyped data from sources only available at runtime enters into our application. Examples include reading a JSON or CSV file from disk, getting a JSON payload from an HTTP request in a controller etc.</p>\n<p>In these scenarios, the data source is not available when the compiler is compiling the code, therefore the compiler can not guarantee the type correctness of the data structures we consume. For such a guarantee to exist, it would be needed to write a validator that validates the incoming data structures at runtime.</p>\n<p>It may be argued that if we have end-to-end control over our application’s lifecycle then we could have ensured that any data source we are reading from at runtime would have ostensibly been generated by type safe code and therefore runtime validations would be unnecessary, however in many practical scenarios this is not the case. We need to fetch data from external APIs, user edited configuration files etc. which are outside the realm of the types defined in our application.</p>\n<p>Similar concerns are also applicable when the whole of the codebase is not yet using a type checker or we are writing a library which we would like to be usable by both javascript and typescript users. However, if the user is not using typescript (or can’t be trusted to not use escape hatches like <code>any</code> or <code>@ts-ignore</code>), we can no longer make assumptions about the interface contracts and when these assumptions fail the error messages can be quite obtuse at times.</p>\n<p>So it is better to have strict validations at the boundaries when untyped data is coerced to typed data structures, so that the rest of our code can make strong assumptions about the type guarantees and can take advantage of a static type checker.</p>\n<h2>Runtime Types</h2>\n<p>io-ts introduces the concept of a runtime type (an instance of the<a href=\"https://github.com/gcanti/io-ts/blob/master/src/index.ts#L43\">&nbsp;Type class</a>) which represents a runtime validator for a typescript (static) type.</p>\n<blockquote><p>A value of type&nbsp;<code>Type&lt;A, O, I&gt;</code>&nbsp;(called “runtime type”) is the runtime representation of the static type&nbsp;<code>A</code>.</p></blockquote>\n<p>In practice, most of the times we would not be instantiating or subclassing Type class directly. Rather we would use many of the Type instances exposed by the library (or helper libraries like <a href=\"https://github.com/gcanti/io-ts-types\">io-ts-types</a>) and take advantage of composability of type instances.</p>\n<p>For example, io-ts exposes a string type, which we can use as follows:</p>\n<div>\n<!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4486e13c3515322799\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13c3515322799-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13c3515322799-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13c3515322799-3\">3</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4486e13c3515322799-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13c3515322799-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">validationResult</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Name</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">decode</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"lorefnon\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13c3515322799-3\"><span class=\"crayon-v\">validationResult</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">isRight</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// ==&gt; true</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0017 seconds] -->\n<br>\nWe can combine these types through combinators to build composite types which represent entities like domain models, request payloads etc. in our applications. For example:<p></p>\n</div>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4486e13da803934028\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13da803934028-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13da803934028-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13da803934028-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13da803934028-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4486e13da803934028-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">type</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13da803934028-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13da803934028-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">number</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13da803934028-4\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0008 seconds] -->\n<p></p>\n<p>Person is an instance of <a href=\"https://github.com/gcanti/io-ts/blob/master/src/index.ts#L452\">InterfaceType</a> class:</p>\n<p><img loading=\"lazy\" class=\"alignnone size-full wp-image-153\" src=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-45-05.png\" alt=\"\" width=\"576\" height=\"195\" srcset=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-45-05.png 576w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-45-05-300x102.png 300w\" sizes=\"(max-width: 576px) 100vw, 576px\"></p>\n<div>So this is conceptually equivalent of defining something like:</div>\n<div>\n<!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4486e13e4339670789\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13e4339670789-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13e4339670789-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13e4339670789-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13e4339670789-4\">4</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4486e13e4339670789-1\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Person</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13e4339670789-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13e4339670789-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13e4339670789-4\"><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0009 seconds] -->\n<br>\nhad we written the same thing as a static type.<p></p>\n</div>\n<p>The advantage of using io-ts to define the runtime type is that we can validate the type at runtime, and we can also <a href=\"https://github.com/gcanti/io-ts#typescript-integration\">extract</a> the corresponding static type, so we don’t have to define it twice.</p>\n<p><img loading=\"lazy\" class=\"alignnone size-full wp-image-154\" src=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-50-00.png\" alt=\"\" width=\"380\" height=\"74\" srcset=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-50-00.png 380w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-50-00-300x58.png 300w\" sizes=\"(max-width: 380px) 100vw, 380px\"></p>\n<div><a href=\"https://github.com/gcanti/io-ts/blob/master/src/index.ts#L29\">t.TypeOf</a>&nbsp;is a simple helper type to extract the static type which the runtime type represents.</div>\n<div></div>\n<div>As the type hint tooltip illustrates this is exactly the same as the interface above, except we didn’t have to write it ourselves.</div>\n<div></div>\n<div>The library is quite unopinionated about what we do with the extracted type. The suggested approach is to use an Error Reporter to handle failures in a manner which makes sense in the specific context. We will consider some other contexts later in this post, but the most common usage is to throw an exception if the runtime type validation fails.</div>\n<div></div>\n<div>\n<!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4486e13eb591316359\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13eb591316359-11\">11</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-1\"><span class=\"crayon-e\">type </span><span class=\"crayon-v\">IPerson</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">TypeOf</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Person</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-3\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">requestPayload</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Lorefnon\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">age</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"30\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-5\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">validationResult</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Person</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">decode</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">requestPayload</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-7\"><span class=\"crayon-c\">// Throws if the value is not typecompliant</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-8\"><span class=\"crayon-c\">// No-op otherwise</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-9\"><span class=\"crayon-v\">ThrowReporter</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">report</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">validationResult</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e13eb591316359-11\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> person:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">IPerson</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">validationResult</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0029 seconds] -->\n<br>\nThis will now fail with a validation error:<p></p>\n</div>\n<p><img loading=\"lazy\" class=\"alignnone size-full wp-image-159\" src=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04.png\" alt=\"\" width=\"919\" height=\"173\" srcset=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04.png 919w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04-300x56.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04-768x145.png 768w\" sizes=\"(max-width: 919px) 100vw, 919px\"></p>\n<div>We can use the extracted static just like any other typescript type:</div>\n<div></div>\n<div>&nbsp;<img loading=\"lazy\" class=\"alignnone size-full wp-image-156\" src=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42.png\" alt=\"\" width=\"821\" height=\"308\" srcset=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42.png 821w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42-300x113.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42-768x288.png 768w\" sizes=\"(max-width: 821px) 100vw, 821px\"></div>\n<div></div>\n<div>However because typescript compiler aggressively flattens type aliases, the error messages can sometimes become unwieldy for large complex types. Note that the error tooltip above does not contain the name IPerson.</div>\n<div></div>\n<div>A simple solution is to define an interface which extends from the generated type:</div>\n<div>\n<div>\n<p><img loading=\"lazy\" class=\"alignnone size-full wp-image-157\" src=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35.png\" alt=\"\" width=\"843\" height=\"308\" srcset=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35.png 843w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35-300x110.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35-768x281.png 768w\" sizes=\"(max-width: 843px) 100vw, 843px\"></p>\n</div>\n<p>This can be extended to compositions:</p>\n</div>\n<div><img loading=\"lazy\" class=\"alignnone size-full wp-image-158\" src=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59.png\" alt=\"\" width=\"837\" height=\"600\" srcset=\"/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59.png 837w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59-300x215.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59-768x551.png 768w\" sizes=\"(max-width: 837px) 100vw, 837px\"></div>\n<div></div>\n<h2><span style=\"font-family: 'Libre Baskerville', serif; font-style: italic;\">Encoding/Decoding</span></h2>\n<p>We noted above that we used the decode method when performing a type validation at runtime.</p>\n<p>When dealing with untyped data obtained at runtime boundaries we often also have to deal with serialization/deserialization and converting the raw data (structure) to a hierarchy of instances of typescript classes relevant to business logic.</p>\n<p>To handle these concerns, the Type class implements of Encoder and Decoder interfaces.</p>\n<blockquote><p>A &nbsp;runtime type can</p>\n<ul>\n<li>decode inputs of type&nbsp;<code>I</code>&nbsp;(through&nbsp;<code>decode</code>)</li>\n<li>encode outputs of type&nbsp;<code>O</code>&nbsp;(through&nbsp;<code>encode</code>)</li>\n<li>be used as a custom type guard (through&nbsp;<code>is</code>)</li>\n</ul>\n</blockquote>\n<p>In a wide number of cases (eg. the examples above) our output type will be same as the static type which the runtime type represents.</p>\n<p>An example where having a separate output type can be useful can be seen in the <a href=\"https://github.com/gcanti/io-ts-types/blob/master/src/Date/DateFromISOString.ts\">DateFromISOStringType</a> where the output type can be an ISO formatted String.</p>\n<p>So we can, for instance, use this runtime type to decode request payloads where the date string is represented as an ISO formatted string. While decoding, this will be converted to a date instance. And when encoding output (eg. when sending response back to client) this will be serialized to a string as per the&nbsp;ISO&nbsp;8601 extended&nbsp;format.</p>\n<p>In this case, this circumvents the limitation of a date type not being supported by json but in general, this strategy can be extended to do things like auto instantiation of Model classes in our application from request payload.</p>\n<h2>Integrations</h2>\n<p>A <a href=\"https://github.com/gcanti/prop-types-ts\">react integration library</a> has been made available by the author of io-ts. This is similar to how prop-types in react used to work, but takes advantage of the more sophisticated runtime type system of io-ts.</p>\n<p>Given the simplicity of the core library and flexibility of error reports, it is also quite easy to integrate the reporters in other contexts.</p>\n<h3>Example : Express middleware</h3>\n<p>We had previously discussed the Throw Reporter for error handling.</p>\n<p>In web applications, we would typically want to reject requests with an appropriate HTTP code on validation failures. This is easily achieved by wrapping the io-ts PathReporter as a middleware. The example below illustrates an express middleware, but besides the middleware signature there is nothing express specific here.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4486e13f5802843459\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-15\">15</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-17\">17</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-19\">19</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-21\">21</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-23\">23</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-25\">25</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-27\">27</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-29\">29</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-31\">31</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-33\">33</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-34\">34</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e13f5802843459-35\">35</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">validationMiddleware</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">reqType</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Type</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">any</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">express</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Request</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">express</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Response</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">next</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">void</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">result</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">reqType</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">decode</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">report</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">PathReporter</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">report</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">result</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">result</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">isRight</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">next</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-i\">res</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">status</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">406</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">json</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">success</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">errors</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">report</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-14\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-15\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-16\"><span class=\"crayon-v\">app</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">get</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'/:requestId'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">validationMiddleware</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">type</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-19\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">params</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">type</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// Ensure that requestId is 4 digit long</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">requestId</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">refinement</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">length</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-22\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-23\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">query</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">type</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-24\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// Ensure that requestType query parameter</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-25\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// is either order or dispatch</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-26\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">requestType</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">union</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-27\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">literal</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"order\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-28\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">literal</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"dispatch\"</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-29\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-30\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-31\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-32\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">json</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-33\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">success</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-34\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e13f5802843459-35\"><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0093 seconds] -->\n<p></p>\n<h2>Limitations</h2>\n<p>The author of io-ts has highlighted some corner cases and workarounds for them in the README.</p>\n<p>These are typically situations where typescript compiler’s inference support is not good enough (yet) eg. recursively defined types. The solution is basically to write <a href=\"https://github.com/gcanti/io-ts#recursive-types\">helper types</a> manually.</p>\n<h2>Comparision with other solutions</h2>\n<h3>Dart/JS++</h3>\n<p>Languages like <a href=\"https://www.dartlang.org/\">Dart</a> and <a href=\"https://www.onux.com/jspp/\">JS++</a> have runtime type systems. While both are very interesting, and in my opinion superior type systems (esp. given that Dart’s type system is now <a href=\"https://www.dartlang.org/guides/language/sound-dart#sound-type-system\">strict and&nbsp;&nbsp;sound</a>, unlike Typescript which considers neither of these to be a design goal), they are not practical solutions for many of the cases I have to deal with.</p>\n<p>In case of JS++ the community adoption is simply too small (as of yet) and in case of Dart there is a significant interop overhead and dart bindings for many libraries are not available yet. Adopting Dart almost implies adopting an another ecosystem.</p>\n<h3>ts-runtime</h3>\n<p>A very interesting attempt has been made by Fabian Pirklbauer in the&nbsp;<a href=\"https://github.com/fabiandev/ts-runtime\">ts-runtime</a>&nbsp;project to extend typescript’s typesystem to runtime through AST transformations. This is a fairly complex and ambitious endeavour and this is reflected in the&nbsp;<a href=\"https://github.com/fabiandev/ts-runtime#limitations\">numerous corner cases</a> that author has highlighted in the documentation. Even if this were production ready (which it is currently not) I’d be sceptical of adopting this unless this were to be officially supported by typescript team.</p>\n<p>I don’t find the complexity (of extending the entire type system transparently to runtime) warranted because typically we would want these validations specifically at runtime boundaries and for the rest of the code static type checking would naturally suffice.</p>\n<h3>typescript-is</h3>\n<p>Wouter van Heeswijk’s typescript-is takes the opposite approach to io-ts and generates runtime types from static types. It is philosophically similar to ts-runtime but limits itself in scope by handling primitives and interfaces.</p>\n<p>Type guards are generated using <a href=\"https://github.com/Microsoft/TypeScript/wiki/Using-the-Compiler-API#a-simple-transform-function\">typescript transformers</a>. This is an interesting approach, and while it requires some configuration during the build step it is quite simple to use.</p>\n<p>Unlike io-ts you give up control over the runtime type, so things like custom encoding/decoding logic etc. have to be handled at a separate layer. I find that to be an acceptable compromise in most scenarios.</p>\n<p>Also, the runtime overhead of this library is much less compared other runtime type implementations here, because it compiles down to a simple chain of if-else statements:</p>\n<p>Taking an example from README:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4486e1403853465711\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e1403853465711-14\">14</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-1\"><span class=\"crayon-e\">import</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'typescript-is'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-3\"><span class=\"crayon-t\">interface</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">MyInterface</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">someObject</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">without</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-7\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-8\"><span class=\"crayon-m\">const</span><span class=\"crayon-v\"> foreignObject:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">any</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">someObject</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'obtained from the wild'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">without</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'type safety'</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-9\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-10\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-st\">is</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">MyInterface</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">foreignObject</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// Call expression returns true</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">someObject</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">foreignObject</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">someObject</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// type: string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">without</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">foreignObject</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">without</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// type: string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e1403853465711-14\"><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0036 seconds] -->\n<p></p>\n<p>The if condition in the snippet above compiles down to:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\n\n\t\t<div id=\"crayon-5fba4486e140d289422725\" class=\"crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;\">\n\t\t\n\t\t\t<div class=\"crayon-plain-wrap\"></div>\n\t\t\t<div class=\"crayon-main\" style=\"\">\n\t\t\t\t<table class=\"crayon-table\">\n\t\t\t\t\t<tbody><tr class=\"crayon-row\">\n\t\t\t\t<td class=\"crayon-nums\" data-settings=\"hide\">\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 15px !important; line-height: 20px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-1\">1</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-3\">3</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-5\">5</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-7\">7</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-9\">9</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-11\">11</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-13\">13</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5fba4486e140d289422725-15\">15</div></div>\n\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-1\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">object</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">object</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"object\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-t\">object</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">!==</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">!</span><span class=\"crayon-t\">Array</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">isArray</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">object</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"someObject\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">object</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">object</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"someObject\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"without\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">object</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">typeof</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">object</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"without\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">foreignObject</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-11\"><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// Call expression returns true</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">someObject</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">foreignObject</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">someObject</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// type: string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">without</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">foreignObject</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">without</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// type: string</span></div><div class=\"crayon-line\" id=\"crayon-5fba4486e140d289422725-15\"><span class=\"crayon-sy\">}</span></div></div></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody></table>\n\t\t\t</div>\n\t\t</div>\n<!-- [Format Time: 0.0033 seconds] -->\n<p></p>\n<p>The cost is obviously that the generated code is bloated with repetitive assertion logic. The project may benefit from some facility to extract the assertion logic into reusable validators.</p>\n<h3>typescript-json-schema</h3>\n<p>This project takes a somewhat different route and generates <a href=\"https://json-schema.org/\">JSON schema</a> from typescript sources. The idea of encoding validation logic as json has never appealed to me, but if are working with other systems that already have good support JSON schema (eg. MongoDB) then this may be a good choice.</p>\n<p>However, io-ts is strictly more powerful than validating against a generated JSON schema because we have much more control over the runtime types.</p>\n<h3>Runtypes</h3>\n<p>Tom Crockett’s <a href=\"https://github.com/pelotom/runtypes\">runtypes</a> project is very similar to io-ts in that it uses the same concept of Runtime Types. However it does not deal with encoding/decoding values and hence the resultant API is somewhat simpler than io-ts.</p>\n<p>However, there are some <a href=\"https://github.com/pelotom/runtypes/issues/42\">known issues</a> around handling of mapped types which have already been <a href=\"https://github.com/gcanti/io-ts/pull/144\">addressed</a> in io-ts.</p>\n\n\n    ",
            "tags": [
                "Typescript"
            ]
        }
    ]
}