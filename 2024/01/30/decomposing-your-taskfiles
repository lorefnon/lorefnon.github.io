<!DOCTYPE html><html class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/blog.css"><title>Lorefnon | Blog | Decomposing your taskfiles</title><meta property="og:title" content="Lorefnon | Blog | Decomposing your taskfiles"><meta property="og:description" content="Ramblings on Web Development and software architecture"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="icon" href="/images/favicon/favicon.ico"><script data-goatcounter="https://analytics.lorefnon.com/count" async src="https://analytics.lorefnon.com/count.js"></script><script src="https://unpkg.com/htmx.org@1.7.0/dist/htmx.min.js" defer></script><script src="https://unpkg.com/dompurify@2.3.6/dist/purify.min.js" defer></script><script src="/js/blog.js" defer></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Icicles of Thought" type="application/atom+xml">
</head><body class="blog-body" hx-boost="true"><div class="blog-summary"><a class="primary-link" href="/" hx-boost="false"><h1 class="header-text">Gaurab Paul</h1><h2 class="header-text">Polyglot software developer &amp; consultant passionate about web development, distributed systems and open source technologies</h2></a><div class="blog-support"><div class="blog-support-cta-container"><a class="blog-support-btn" href="https://ko-fi.com/lorefnon" target="_blank" title="Support my work"></a></div></div></div><div class="blog-sidebar"><div class="blog-support"><div class="blog-support-cta-container"><a class="blog-support-btn" href="https://ko-fi.com/lorefnon" target="_blank" title="Support my work"></a><div class="blog-support-arrow"></div><p class="support-text body-text">Support my blog and open-source work</p></div></div><h1 class="header-text">Tags</h1><ul class="tag-list"><li class="body-text"><a class="tag-link" href="/tags/taskfile/"><img src="/images/tag.svg">taskfile</a></li></ul></div><div class="blog-header blog-post-header"><div class="blog-post-header-inner"><div class="header-text">Decomposing your taskfiles</div><div class="posted-date sub-header-text" title="2024-01-29">Posted &nbsp;42 minutes ago</div><hr class="blog-header-separator"></div></div><div class="blog-main"><div class="page-content"><p><a href="https://taskfile.dev/" target="_blank" rel="noopener external nofollow noreferrer">Taskfile.dev</a> is a very convenient language&#x2F;framework agnostic task runner that I frequently use in larger projects - esp. ones that are composed of polyglot services. It is also a nice alternative to npm scripts which start to get unweidly once you begin to have dependencies that you want to run in parallel, want to run certain scripts in certain folder etc.</p>
<p>However, sooner or later, the primary taskfile grows quite large as we add more and more tasks.</p>
<p>Fortunately taskfile has a nice solution for this, we can include other taskfiles in a taskfile.</p>
<pre><code class="hljs plaintext">version: &quot;3&quot;

includes:
  backend:
    taskfile: ./modules/backend/Taskfile.part.yaml
    dir: ./modules/backend
  frontend:
    taskfile: ./modules/frontend/Taskfile.part.yaml
    dir: ./modules/frontend</code></pre>

<p>This is particularly convenient for monorepos where each module will typically have a set of closely related set of tasks that depend on each other, but are otherwise unrelated to tasks for other modules&#x2F;services. Its also nice that all the tasks get auto-prefixed so a <code>build</code> task defined in <code>backend/Taskfile.part.yaml</code> will be available as <code>backend:build</code>.</p>
<p>Note that we named our constituent taskfiles as <code>Taskfile.part.yaml</code> rather than <code>Taskfile.yaml</code>.</p>
<p>If we use  the latter, any tasks defined in the top level <code>Taskfile.yaml</code> will become inaccessible while we are in child directories because task will just find the first <code>Taskfile.yaml</code> in parent directory and stop there. So any tasks in parent taskfile will not be found. It also causes confusion because in subdirectories we will need to use unprefixed tasks where as in top level we will need to run prefixed tasks.</p>
<p>If you use yaml-language-server, you can get autocompletion and checking for your Taskfile.part.yaml files by adding this comment to top: </p>
<pre><code class="hljs plaintext"># yaml-language-server: $schema=https://taskfile.dev/schema.json</code></pre>
</div><div class="post-comments"><!-- .comments-target--></div><div class="post-comments" style="margin-top: 10px;"><div id="remark42"></div></div></div><div class="blog-footer body-text"><p class="copyright-container"><strong>Â© 2022 Gaurab Paul</strong></p><p>Unless otherwise mentioned in specific contexts, all code is licensed under the The MIT License and all content and artwork is licensed under CC BY-NC-SA.</p><p>The opinions expressed herein are author's personal viewpoints and may not be taken as professional recommendations from any of his previous or current employers.</p></div></body></html>