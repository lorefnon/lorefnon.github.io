<!DOCTYPE html><html class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/blog.css"><title>Lorefnon | Blog | Typescript and validations at runtime boundaries</title><meta property="og:title" content="Lorefnon | Blog | Typescript and validations at runtime boundaries"><meta property="og:description" content="Ramblings on Web Development and software architecture"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="icon" href="/images/favicon/favicon.ico"><script data-goatcounter="https://analytics.lorefnon.com/count" async src="https://analytics.lorefnon.com/count.js"></script><script src="https://unpkg.com/htmx.org@1.7.0/dist/htmx.min.js" defer></script><script src="https://unpkg.com/dompurify@2.3.6/dist/purify.min.js" defer></script><script src="/js/blog.js" defer></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Icicles of Thought" type="application/atom+xml">
</head><body class="blog-body" hx-boost="true"><div class="blog-summary"><a class="primary-link" href="/" hx-boost="false"><h1 class="header-text">Gaurab Paul</h1><h2 class="header-text">Polyglot software developer &amp; consultant passionate about web development, distributed systems and open source technologies</h2></a><div class="blog-support"><div class="blog-support-cta-container"><a class="blog-support-btn" href="https://ko-fi.com/lorefnon" target="_blank" title="Support my work"></a></div></div></div><div class="blog-sidebar"><div class="blog-support"><div class="blog-support-cta-container"><a class="blog-support-btn" href="https://ko-fi.com/lorefnon" target="_blank" title="Support my work"></a><div class="blog-support-arrow"></div><p class="support-text body-text">Support my blog and open-source work</p></div></div><h1 class="header-text">Tags</h1><ul class="tag-list"><li class="body-text"><a class="tag-link" href="/tags/Typescript/"><img src="/images/tag.svg">Typescript</a></li></ul></div><div class="blog-header blog-post-header"><div class="blog-post-header-inner"><div class="header-text">Typescript and validations at runtime boundaries</div><div class="posted-date sub-header-text" title="2018-03-24">Posted &nbsp;5 years ago</div><hr class="blog-header-separator"></div></div><div class="blog-main"><div class="page-content"><link rel="stylesheet" href="/css/crayon.min.css" >
<link rel="stylesheet" href="/css/crayon-flatui-light.css" >



	<p>Typescript team has <a target="_blank" rel="noopener" href="https://github.com/Microsoft/TypeScript/issues/1573#issuecomment-68374376">explicitly stated</a> that they don’t intend to extend typescript’s static type checking to the runtime.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Microsoft/TypeScript/wiki/TypeScript-Design-Goals">Typescript Design Goals</a> lists the following in the section on Non-goals:</p>
<blockquote><p>Add or rely on run-time type information in programs, or emit different code based on the results of the type system. Instead, encourage programming patterns that do not require run-time metadata.</p></blockquote>
<p>While on one hand this design goal is advantageous in that the output generated by typescript is very close to what hand written javascript would have looked like. And the runtime cost of typescript remains close to zero, therefore adoption of typescript does not alter performance characteristics of an application.</p>
<p>However, this also implies that for cases when static typing cannot help us we need to separately write validators using a validation library (eg. <a target="_blank" rel="noopener" href="https://github.com/hapijs/joi">Joi</a>) which has to be kept in sync with the typescript types.</p>
<p>This post outlines an approach to eliminate this redundancy using the <a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts">io-ts</a> library by <a target="_blank" rel="noopener" href="https://gcanti.github.io/about.html">Giulio Canti</a>. This approach has also been adopted by some other libraries like <a target="_blank" rel="noopener" href="https://github.com/mobxjs/mobx-state-tree">MobX State Tree</a> and <a target="_blank" rel="noopener" href="https://github.com/pelotom/runtypes">Runtypes</a>.</p>
<p><span id="more-150"></span></p>
<h2>Runtime Boundaries</h2>
<p>Runtime boundaries are cases where some untyped data from sources only available at runtime enters into our application. Examples include reading a JSON or CSV file from disk, getting a JSON payload from an HTTP request in a controller etc.</p>
<p>In these scenarios, the data source is not available when the compiler is compiling the code, therefore the compiler can not guarantee the type correctness of the data structures we consume. For such a guarantee to exist, it would be needed to write a validator that validates the incoming data structures at runtime.</p>
<p>It may be argued that if we have end-to-end control over our application’s lifecycle then we could have ensured that any data source we are reading from at runtime would have ostensibly been generated by type safe code and therefore runtime validations would be unnecessary, however in many practical scenarios this is not the case. We need to fetch data from external APIs, user edited configuration files etc. which are outside the realm of the types defined in our application.</p>
<p>Similar concerns are also applicable when the whole of the codebase is not yet using a type checker or we are writing a library which we would like to be usable by both javascript and typescript users. However, if the user is not using typescript (or can’t be trusted to not use escape hatches like <code>any</code> or <code>@ts-ignore</code>), we can no longer make assumptions about the interface contracts and when these assumptions fail the error messages can be quite obtuse at times.</p>
<p>So it is better to have strict validations at the boundaries when untyped data is coerced to typed data structures, so that the rest of our code can make strong assumptions about the type guarantees and can take advantage of a static type checker.</p>
<h2>Runtime Types</h2>
<p>io-ts introduces the concept of a runtime type (an instance of the<a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts/blob/master/src/index.ts#L43">&nbsp;Type class</a>) which represents a runtime validator for a typescript (static) type.</p>
<blockquote><p>A value of type&nbsp;<code>Type&lt;A, O, I&gt;</code>&nbsp;(called “runtime type”) is the runtime representation of the static type&nbsp;<code>A</code>.</p></blockquote>
<p>In practice, most of the times we would not be instantiating or subclassing Type class directly. Rather we would use many of the Type instances exposed by the library (or helper libraries like <a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts-types">io-ts-types</a>) and take advantage of composability of type instances.</p>
<p>For example, io-ts exposes a string type, which we can use as follows:</p>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5fba4486e13c3515322799" class="crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums" data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5fba4486e13c3515322799-1">1</div><div class="crayon-num" data-line="crayon-5fba4486e13c3515322799-2">2</div><div class="crayon-num" data-line="crayon-5fba4486e13c3515322799-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5fba4486e13c3515322799-1"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">Name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-t">string</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13c3515322799-2"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">validationResult</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Name</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">"lorefnon"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13c3515322799-3"><span class="crayon-v">validationResult</span><span class="crayon-sy">.</span><span class="crayon-e">isRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// ==&gt; true</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<br>
We can combine these types through combinators to build composite types which represent entities like domain models, request payloads etc. in our applications. For example:<p></p>
</div>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5fba4486e13da803934028" class="crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums" data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5fba4486e13da803934028-1">1</div><div class="crayon-num" data-line="crayon-5fba4486e13da803934028-2">2</div><div class="crayon-num" data-line="crayon-5fba4486e13da803934028-3">3</div><div class="crayon-num" data-line="crayon-5fba4486e13da803934028-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5fba4486e13da803934028-1"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">Person</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13da803934028-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-t">string</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5fba4486e13da803934028-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">age</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-i">number</span></div><div class="crayon-line" id="crayon-5fba4486e13da803934028-4"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>Person is an instance of <a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts/blob/master/src/index.ts#L452">InterfaceType</a> class:</p>
<p><img loading="lazy" class="alignnone size-full wp-image-153" src="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-45-05.png" alt="" width="576" height="195" srcset="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-45-05.png 576w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-45-05-300x102.png 300w" sizes="(max-width: 576px) 100vw, 576px"></p>
<div>So this is conceptually equivalent of defining something like:</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5fba4486e13e4339670789" class="crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums" data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5fba4486e13e4339670789-1">1</div><div class="crayon-num" data-line="crayon-5fba4486e13e4339670789-2">2</div><div class="crayon-num" data-line="crayon-5fba4486e13e4339670789-3">3</div><div class="crayon-num" data-line="crayon-5fba4486e13e4339670789-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5fba4486e13e4339670789-1"><span class="crayon-t">interface</span><span class="crayon-h"> </span><span class="crayon-e">Person</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13e4339670789-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13e4339670789-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">age</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">number</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13e4339670789-4"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<br>
had we written the same thing as a static type.<p></p>
</div>
<p>The advantage of using io-ts to define the runtime type is that we can validate the type at runtime, and we can also <a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts#typescript-integration">extract</a> the corresponding static type, so we don’t have to define it twice.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-154" src="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-50-00.png" alt="" width="380" height="74" srcset="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-50-00.png 380w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-15-50-00-300x58.png 300w" sizes="(max-width: 380px) 100vw, 380px"></p>
<div><a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts/blob/master/src/index.ts#L29">t.TypeOf</a>&nbsp;is a simple helper type to extract the static type which the runtime type represents.</div>
<div></div>
<div>As the type hint tooltip illustrates this is exactly the same as the interface above, except we didn’t have to write it ourselves.</div>
<div></div>
<div>The library is quite unopinionated about what we do with the extracted type. The suggested approach is to use an Error Reporter to handle failures in a manner which makes sense in the specific context. We will consider some other contexts later in this post, but the most common usage is to throw an exception if the runtime type validation fails.</div>
<div></div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5fba4486e13eb591316359" class="crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums" data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-1">1</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-2">2</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-3">3</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-4">4</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-5">5</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-6">6</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-7">7</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-8">8</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-9">9</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-10">10</div><div class="crayon-num" data-line="crayon-5fba4486e13eb591316359-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5fba4486e13eb591316359-1"><span class="crayon-e">type </span><span class="crayon-v">IPerson</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">TypeOf</span><span class="crayon-o">&lt;</span><span class="crayon-r">typeof</span><span class="crayon-h"> </span><span class="crayon-v">Person</span><span class="crayon-o">&gt;</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-2">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-3"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">requestPayload</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Lorefnon"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">age</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"30"</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-4">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-5"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">validationResult</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Person</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-v">requestPayload</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-6">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-7"><span class="crayon-c">// Throws if the value is not typecompliant</span></div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-8"><span class="crayon-c">// No-op otherwise</span></div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-9"><span class="crayon-v">ThrowReporter</span><span class="crayon-sy">.</span><span class="crayon-e">report</span><span class="crayon-sy">(</span><span class="crayon-v">validationResult</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-10">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e13eb591316359-11"><span class="crayon-m">const</span><span class="crayon-v"> person:</span><span class="crayon-h"> </span><span class="crayon-v">IPerson</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">validationResult</span><span class="crayon-sy">.</span><span class="crayon-v">value</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<br>
This will now fail with a validation error:<p></p>
</div>
<p><img loading="lazy" class="alignnone size-full wp-image-159" src="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04.png" alt="" width="919" height="173" srcset="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04.png 919w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04-300x56.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-37-04-768x145.png 768w" sizes="(max-width: 919px) 100vw, 919px"></p>
<div>We can use the extracted static just like any other typescript type:</div>
<div></div>
<div>&nbsp;<img loading="lazy" class="alignnone size-full wp-image-156" src="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42.png" alt="" width="821" height="308" srcset="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42.png 821w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42-300x113.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-21-42-768x288.png 768w" sizes="(max-width: 821px) 100vw, 821px"></div>
<div></div>
<div>However because typescript compiler aggressively flattens type aliases, the error messages can sometimes become unwieldy for large complex types. Note that the error tooltip above does not contain the name IPerson.</div>
<div></div>
<div>A simple solution is to define an interface which extends from the generated type:</div>
<div>
<div>
<p><img loading="lazy" class="alignnone size-full wp-image-157" src="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35.png" alt="" width="843" height="308" srcset="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35.png 843w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35-300x110.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-35-768x281.png 768w" sizes="(max-width: 843px) 100vw, 843px"></p>
</div>
<p>This can be extended to compositions:</p>
</div>
<div><img loading="lazy" class="alignnone size-full wp-image-158" src="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59.png" alt="" width="837" height="600" srcset="/wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59.png 837w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59-300x215.png 300w, /wp-content/uploads/2018/03/Screenshot-from-2018-03-25-16-29-59-768x551.png 768w" sizes="(max-width: 837px) 100vw, 837px"></div>
<div></div>
<h2><span style="font-family: 'Libre Baskerville', serif; font-style: italic;">Encoding/Decoding</span></h2>
<p>We noted above that we used the decode method when performing a type validation at runtime.</p>
<p>When dealing with untyped data obtained at runtime boundaries we often also have to deal with serialization/deserialization and converting the raw data (structure) to a hierarchy of instances of typescript classes relevant to business logic.</p>
<p>To handle these concerns, the Type class implements of Encoder and Decoder interfaces.</p>
<blockquote><p>A &nbsp;runtime type can</p>
<ul>
<li>decode inputs of type&nbsp;<code>I</code>&nbsp;(through&nbsp;<code>decode</code>)</li>
<li>encode outputs of type&nbsp;<code>O</code>&nbsp;(through&nbsp;<code>encode</code>)</li>
<li>be used as a custom type guard (through&nbsp;<code>is</code>)</li>
</ul>
</blockquote>
<p>In a wide number of cases (eg. the examples above) our output type will be same as the static type which the runtime type represents.</p>
<p>An example where having a separate output type can be useful can be seen in the <a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts-types/blob/master/src/Date/DateFromISOString.ts">DateFromISOStringType</a> where the output type can be an ISO formatted String.</p>
<p>So we can, for instance, use this runtime type to decode request payloads where the date string is represented as an ISO formatted string. While decoding, this will be converted to a date instance. And when encoding output (eg. when sending response back to client) this will be serialized to a string as per the&nbsp;ISO&nbsp;8601 extended&nbsp;format.</p>
<p>In this case, this circumvents the limitation of a date type not being supported by json but in general, this strategy can be extended to do things like auto instantiation of Model classes in our application from request payload.</p>
<h2>Integrations</h2>
<p>A <a target="_blank" rel="noopener" href="https://github.com/gcanti/prop-types-ts">react integration library</a> has been made available by the author of io-ts. This is similar to how prop-types in react used to work, but takes advantage of the more sophisticated runtime type system of io-ts.</p>
<p>Given the simplicity of the core library and flexibility of error reports, it is also quite easy to integrate the reporters in other contexts.</p>
<h3>Example : Express middleware</h3>
<p>We had previously discussed the Throw Reporter for error handling.</p>
<p>In web applications, we would typically want to reject requests with an appropriate HTTP code on validation failures. This is easily achieved by wrapping the io-ts PathReporter as a middleware. The example below illustrates an express middleware, but besides the middleware signature there is nothing express specific here.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5fba4486e13f5802843459" class="crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums" data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-1">1</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-2">2</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-3">3</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-4">4</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-5">5</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-6">6</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-7">7</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-8">8</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-9">9</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-10">10</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-11">11</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-12">12</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-13">13</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-14">14</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-15">15</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-16">16</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-17">17</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-18">18</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-19">19</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-20">20</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-21">21</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-22">22</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-23">23</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-24">24</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-25">25</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-26">26</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-27">27</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-28">28</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-29">29</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-30">30</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-31">31</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-32">32</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-33">33</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-34">34</div><div class="crayon-num" data-line="crayon-5fba4486e13f5802843459-35">35</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5fba4486e13f5802843459-1"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">validationMiddleware</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">reqType</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">Type</span><span class="crayon-o">&lt;</span><span class="crayon-v">any</span><span class="crayon-o">&gt;</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-sy">.</span><span class="crayon-v">Request</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-sy">.</span><span class="crayon-v">Response</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">next</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reqType</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">report</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">PathReporter</span><span class="crayon-sy">.</span><span class="crayon-e">report</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-e">isRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">next</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">res</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">406</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">errors</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">report</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-14"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-15">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-16"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'/:requestId'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">validationMiddleware</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">params</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Ensure that requestId is 4 digit long</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">requestId</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">refinement</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-t">string</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">query</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Ensure that requestType query parameter</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// is either order or dispatch</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">requestType</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">union</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">literal</span><span class="crayon-sy">(</span><span class="crayon-s">"order"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">literal</span><span class="crayon-sy">(</span><span class="crayon-s">"dispatch"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e13f5802843459-35"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0093 seconds] -->
<p></p>
<h2>Limitations</h2>
<p>The author of io-ts has highlighted some corner cases and workarounds for them in the README.</p>
<p>These are typically situations where typescript compiler’s inference support is not good enough (yet) eg. recursively defined types. The solution is basically to write <a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts#recursive-types">helper types</a> manually.</p>
<h2>Comparision with other solutions</h2>
<h3>Dart/JS++</h3>
<p>Languages like <a target="_blank" rel="noopener" href="https://www.dartlang.org/">Dart</a> and <a target="_blank" rel="noopener" href="https://www.onux.com/jspp/">JS++</a> have runtime type systems. While both are very interesting, and in my opinion superior type systems (esp. given that Dart’s type system is now <a target="_blank" rel="noopener" href="https://www.dartlang.org/guides/language/sound-dart#sound-type-system">strict and&nbsp;&nbsp;sound</a>, unlike Typescript which considers neither of these to be a design goal), they are not practical solutions for many of the cases I have to deal with.</p>
<p>In case of JS++ the community adoption is simply too small (as of yet) and in case of Dart there is a significant interop overhead and dart bindings for many libraries are not available yet. Adopting Dart almost implies adopting an another ecosystem.</p>
<h3>ts-runtime</h3>
<p>A very interesting attempt has been made by Fabian Pirklbauer in the&nbsp;<a target="_blank" rel="noopener" href="https://github.com/fabiandev/ts-runtime">ts-runtime</a>&nbsp;project to extend typescript’s typesystem to runtime through AST transformations. This is a fairly complex and ambitious endeavour and this is reflected in the&nbsp;<a target="_blank" rel="noopener" href="https://github.com/fabiandev/ts-runtime#limitations">numerous corner cases</a> that author has highlighted in the documentation. Even if this were production ready (which it is currently not) I’d be sceptical of adopting this unless this were to be officially supported by typescript team.</p>
<p>I don’t find the complexity (of extending the entire type system transparently to runtime) warranted because typically we would want these validations specifically at runtime boundaries and for the rest of the code static type checking would naturally suffice.</p>
<h3>typescript-is</h3>
<p>Wouter van Heeswijk’s typescript-is takes the opposite approach to io-ts and generates runtime types from static types. It is philosophically similar to ts-runtime but limits itself in scope by handling primitives and interfaces.</p>
<p>Type guards are generated using <a target="_blank" rel="noopener" href="https://github.com/Microsoft/TypeScript/wiki/Using-the-Compiler-API#a-simple-transform-function">typescript transformers</a>. This is an interesting approach, and while it requires some configuration during the build step it is quite simple to use.</p>
<p>Unlike io-ts you give up control over the runtime type, so things like custom encoding/decoding logic etc. have to be handled at a separate layer. I find that to be an acceptable compromise in most scenarios.</p>
<p>Also, the runtime overhead of this library is much less compared other runtime type implementations here, because it compiles down to a simple chain of if-else statements:</p>
<p>Taking an example from README:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5fba4486e1403853465711" class="crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums" data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-1">1</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-2">2</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-3">3</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-4">4</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-5">5</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-6">6</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-7">7</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-8">8</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-9">9</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-10">10</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-11">11</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-12">12</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-13">13</div><div class="crayon-num" data-line="crayon-5fba4486e1403853465711-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5fba4486e1403853465711-1"><span class="crayon-e">import</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-i">from</span><span class="crayon-h"> </span><span class="crayon-s">'typescript-is'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-2">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e1403853465711-3"><span class="crayon-t">interface</span><span class="crayon-h"> </span><span class="crayon-e">MyInterface</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">someObject</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">without</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-6"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-7">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e1403853465711-8"><span class="crayon-m">const</span><span class="crayon-v"> foreignObject:</span><span class="crayon-h"> </span><span class="crayon-v">any</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">someObject</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'obtained from the wild'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">without</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'type safety'</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-9">&nbsp;</div><div class="crayon-line" id="crayon-5fba4486e1403853465711-10"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">is</span><span class="crayon-o">&lt;</span><span class="crayon-v">MyInterface</span><span class="crayon-o">&gt;</span><span class="crayon-sy">(</span><span class="crayon-v">foreignObject</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Call expression returns true</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">someObject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">foreignObject</span><span class="crayon-sy">.</span><span class="crayon-v">someObject</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// type: string</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">without</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">foreignObject</span><span class="crayon-sy">.</span><span class="crayon-v">without</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// type: string</span></div><div class="crayon-line" id="crayon-5fba4486e1403853465711-14"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p></p>
<p>The if condition in the snippet above compiles down to:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5fba4486e140d289422725" class="crayon-syntax crayon-theme-flatui-light crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums" data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-1">1</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-2">2</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-3">3</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-4">4</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-5">5</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-6">6</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-7">7</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-8">8</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-9">9</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-10">10</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-11">11</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-12">12</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-13">13</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-14">14</div><div class="crayon-num" data-line="crayon-5fba4486e140d289422725-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5fba4486e140d289422725-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-t">object</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">typeof</span><span class="crayon-h"> </span><span class="crayon-t">object</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-s">"object"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">object</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">!</span><span class="crayon-t">Array</span><span class="crayon-sy">.</span><span class="crayon-e">isArray</span><span class="crayon-sy">(</span><span class="crayon-t">object</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">"someObject"</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-t">object</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">typeof</span><span class="crayon-h"> </span><span class="crayon-t">object</span><span class="crayon-sy">[</span><span class="crayon-s">"someObject"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-s">"string"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">"without"</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-t">object</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">typeof</span><span class="crayon-h"> </span><span class="crayon-t">object</span><span class="crayon-sy">[</span><span class="crayon-s">"without"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-s">"string"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">foreignObject</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-11"><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Call expression returns true</span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">someObject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">foreignObject</span><span class="crayon-sy">.</span><span class="crayon-v">someObject</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// type: string</span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">without</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">foreignObject</span><span class="crayon-sy">.</span><span class="crayon-v">without</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// type: string</span></div><div class="crayon-line" id="crayon-5fba4486e140d289422725-15"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p></p>
<p>The cost is obviously that the generated code is bloated with repetitive assertion logic. The project may benefit from some facility to extract the assertion logic into reusable validators.</p>
<h3>typescript-json-schema</h3>
<p>This project takes a somewhat different route and generates <a target="_blank" rel="noopener" href="https://json-schema.org/">JSON schema</a> from typescript sources. The idea of encoding validation logic as json has never appealed to me, but if are working with other systems that already have good support JSON schema (eg. MongoDB) then this may be a good choice.</p>
<p>However, io-ts is strictly more powerful than validating against a generated JSON schema because we have much more control over the runtime types.</p>
<h3>Runtypes</h3>
<p>Tom Crockett’s <a target="_blank" rel="noopener" href="https://github.com/pelotom/runtypes">runtypes</a> project is very similar to io-ts in that it uses the same concept of Runtime Types. However it does not deal with encoding/decoding values and hence the resultant API is somewhat simpler than io-ts.</p>
<p>However, there are some <a target="_blank" rel="noopener" href="https://github.com/pelotom/runtypes/issues/42">known issues</a> around handling of mapped types which have already been <a target="_blank" rel="noopener" href="https://github.com/gcanti/io-ts/pull/144">addressed</a> in io-ts.</p>


    </div><div class="post-comments"><!-- .comments-target--></div><div class="post-comments" style="margin-top: 10px;"><div id="remark42"></div></div></div><div class="blog-footer body-text"><p class="copyright-container"><strong>© 2022 Gaurab Paul</strong></p><p>Unless otherwise mentioned in specific contexts, all code is licensed under the The MIT License and all content and artwork is licensed under CC BY-NC-SA.</p><p>The opinions expressed herein are author's personal viewpoints and may not be taken as professional recommendations from any of his previous or current employers.</p></div></body></html>